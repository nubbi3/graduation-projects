<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <style>
  @font-face {
  font-family: octicons-link;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
}

.markdown-body .anchor {
  float: left;
  line-height: 1;
  margin-left: -20px;
  padding-right: 4px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #1b1f23;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #24292e;
  line-height: 1.5;
  font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .pl-c {
  color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #6f42c1;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #24292e;
}

.markdown-body .pl-ent {
  color: #22863a;
}

.markdown-body .pl-k {
  color: #d73a49;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #032f62;
}

.markdown-body .pl-smw,
.markdown-body .pl-v {
  color: #e36209;
}

.markdown-body .pl-bu {
  color: #b31d28;
}

.markdown-body .pl-ii {
  background-color: #b31d28;
  color: #fafbfc;
}

.markdown-body .pl-c2 {
  background-color: #d73a49;
  color: #fafbfc;
}

.markdown-body .pl-c2:before {
  content: "^M";
}

.markdown-body .pl-sr .pl-cce {
  color: #22863a;
  font-weight: 700;
}

.markdown-body .pl-ml {
  color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #005cc5;
  font-weight: 700;
}

.markdown-body .pl-mi {
  color: #24292e;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #24292e;
  font-weight: 700;
}

.markdown-body .pl-md {
  background-color: #ffeef0;
  color: #b31d28;
}

.markdown-body .pl-mi1 {
  background-color: #f0fff4;
  color: #22863a;
}

.markdown-body .pl-mc {
  background-color: #ffebda;
  color: #e36209;
}

.markdown-body .pl-mi2 {
  background-color: #005cc5;
  color: #f6f8fa;
}

.markdown-body .pl-mdr {
  color: #6f42c1;
  font-weight: 700;
}

.markdown-body .pl-ba {
  color: #586069;
}

.markdown-body .pl-sg {
  color: #959da5;
}

.markdown-body .pl-corl {
  color: #032f62;
  text-decoration: underline;
}

.markdown-body details {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline-width: 0;
}

.markdown-body strong {
  font-weight: inherit;
  font-weight: bolder;
}

.markdown-body h1 {
  font-size: 2em;
  margin: .67em 0;
}

.markdown-body img {
  border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace,monospace;
  font-size: 1em;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

.markdown-body input {
  font: inherit;
  margin: 0;
}

.markdown-body input {
  overflow: visible;
}

.markdown-body [type=checkbox] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body a {
  color: #0366d6;
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 600;
}

.markdown-body hr {
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
  height: 0;
  margin: 15px 0;
  overflow: hidden;
}

.markdown-body hr:before {
  content: "";
  display: table;
}

.markdown-body hr:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body h1 {
  font-size: 32px;
}

.markdown-body h1,
.markdown-body h2 {
  font-weight: 600;
}

.markdown-body h2 {
  font-size: 24px;
}

.markdown-body h3 {
  font-size: 20px;
}

.markdown-body h3,
.markdown-body h4 {
  font-weight: 600;
}

.markdown-body h4 {
  font-size: 16px;
}

.markdown-body h5 {
  font-size: 14px;
}

.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
}

.markdown-body h6 {
  font-size: 12px;
}

.markdown-body p {
  margin-bottom: 10px;
  margin-top: 0;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ol,
.markdown-body ul {
  margin-bottom: 0;
  margin-top: 0;
  padding-left: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ol ol ol,
.markdown-body ol ul ol,
.markdown-body ul ol ol,
.markdown-body ul ul ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre {
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body input::-webkit-inner-spin-button,
.markdown-body input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

.markdown-body .border {
  border: 1px solid #e1e4e8!important;
}

.markdown-body .border-0 {
  border: 0!important;
}

.markdown-body .border-bottom {
  border-bottom: 1px solid #e1e4e8!important;
}

.markdown-body .rounded-1 {
  border-radius: 3px!important;
}

.markdown-body .bg-white {
  background-color: #fff!important;
}

.markdown-body .bg-gray-light {
  background-color: #fafbfc!important;
}

.markdown-body .text-gray-light {
  color: #6a737d!important;
}

.markdown-body .mb-0 {
  margin-bottom: 0!important;
}

.markdown-body .my-2 {
  margin-bottom: 8px!important;
  margin-top: 8px!important;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .py-0 {
  padding-bottom: 0!important;
  padding-top: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .py-2 {
  padding-bottom: 8px!important;
  padding-top: 8px!important;
}

.markdown-body .pl-3,
.markdown-body .px-3 {
  padding-left: 16px!important;
}

.markdown-body .px-3 {
  padding-right: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .f6 {
  font-size: 12px!important;
}

.markdown-body .lh-condensed {
  line-height: 1.25!important;
}

.markdown-body .text-bold {
  font-weight: 600!important;
}

.markdown-body:before {
  content: "";
  display: table;
}

.markdown-body:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body>:first-child {
  margin-top: 0!important;
}

.markdown-body>:last-child {
  margin-bottom: 0!important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body blockquote,
.markdown-body dl,
.markdown-body ol,
.markdown-body p,
.markdown-body pre,
.markdown-body table,
.markdown-body ul {
  margin-bottom: 16px;
  margin-top: 0;
}

.markdown-body hr {
  background-color: #e1e4e8;
  border: 0;
  height: .25em;
  margin: 24px 0;
  padding: 0;
}

.markdown-body blockquote {
  border-left: .25em solid #dfe2e5;
  color: #6a737d;
  padding: 0 1em;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
  color: #444d56;
  display: inline-block;
  font-size: 11px;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
  line-height: 1.25;
  margin-bottom: 16px;
  margin-top: 24px;
}

.markdown-body h1 {
  font-size: 2em;
}

.markdown-body h1,
.markdown-body h2 {
  border-bottom: 1px solid #eaecef;
  padding-bottom: .3em;
}

.markdown-body h2 {
  font-size: 1.5em;
}

.markdown-body h3 {
  font-size: 1.25em;
}

.markdown-body h4 {
  font-size: 1em;
}

.markdown-body h5 {
  font-size: .875em;
}

.markdown-body h6 {
  color: #6a737d;
  font-size: .85em;
}

.markdown-body ol,
.markdown-body ul {
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ol ul,
.markdown-body ul ol,
.markdown-body ul ul {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body li {
  word-wrap: break-all;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
  margin-top: 16px;
  padding: 0;
}

.markdown-body dl dd {
  margin-bottom: 16px;
  padding: 0 16px;
}

.markdown-body table {
  display: block;
  overflow: auto;
  width: 100%;
}

.markdown-body table th {
  font-weight: 600;
}

.markdown-body table td,
.markdown-body table th {
  border: 1px solid #dfe2e5;
  padding: 6px 13px;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.markdown-body img {
  background-color: #fff;
  box-sizing: content-box;
  max-width: 100%;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body code {
  background-color: rgba(27,31,35,.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  padding: .2em .4em;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre>code {
  background: transparent;
  border: 0;
  font-size: 100%;
  margin: 0;
  padding: 0;
  white-space: pre;
  word-break: normal;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

.markdown-body pre code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  max-width: auto;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
}

.markdown-body .commit-tease-sha {
  color: #444d56;
  display: inline-block;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 90%;
}

.markdown-body .blob-wrapper {
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  overflow-x: auto;
  overflow-y: hidden;
}

.markdown-body .blob-wrapper-embedded {
  max-height: 240px;
  overflow-y: auto;
}

.markdown-body .blob-num {
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  color: rgba(27,31,35,.3);
  cursor: pointer;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  line-height: 20px;
  min-width: 50px;
  padding-left: 10px;
  padding-right: 10px;
  text-align: right;
  user-select: none;
  vertical-align: top;
  white-space: nowrap;
  width: 1%;
}

.markdown-body .blob-num:hover {
  color: rgba(27,31,35,.6);
}

.markdown-body .blob-num:before {
  content: attr(data-line-number);
}

.markdown-body .blob-code {
  line-height: 20px;
  padding-left: 10px;
  padding-right: 10px;
  position: relative;
  vertical-align: top;
}

.markdown-body .blob-code-inner {
  color: #24292e;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  overflow: visible;
  white-space: pre;
  word-wrap: normal;
}

.markdown-body .pl-token.active,
.markdown-body .pl-token:hover {
  background: #ffea7f;
  cursor: pointer;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
  color: #444d56;
  display: inline-block;
  font: 11px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  border-color: #0366d6;
  position: relative;
  z-index: 1;
}

.markdown-body .tab-size[data-tab-size="1"] {
  -moz-tab-size: 1;
  tab-size: 1;
}

.markdown-body .tab-size[data-tab-size="2"] {
  -moz-tab-size: 2;
  tab-size: 2;
}

.markdown-body .tab-size[data-tab-size="3"] {
  -moz-tab-size: 3;
  tab-size: 3;
}

.markdown-body .tab-size[data-tab-size="4"] {
  -moz-tab-size: 4;
  tab-size: 4;
}

.markdown-body .tab-size[data-tab-size="5"] {
  -moz-tab-size: 5;
  tab-size: 5;
}

.markdown-body .tab-size[data-tab-size="6"] {
  -moz-tab-size: 6;
  tab-size: 6;
}

.markdown-body .tab-size[data-tab-size="7"] {
  -moz-tab-size: 7;
  tab-size: 7;
}

.markdown-body .tab-size[data-tab-size="8"] {
  -moz-tab-size: 8;
  tab-size: 8;
}

.markdown-body .tab-size[data-tab-size="9"] {
  -moz-tab-size: 9;
  tab-size: 9;
}

.markdown-body .tab-size[data-tab-size="10"] {
  -moz-tab-size: 10;
  tab-size: 10;
}

.markdown-body .tab-size[data-tab-size="11"] {
  -moz-tab-size: 11;
  tab-size: 11;
}

.markdown-body .tab-size[data-tab-size="12"] {
  -moz-tab-size: 12;
  tab-size: 12;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 .2em .25em -1.6em;
  vertical-align: middle;
}

.markdown-body hr {
  border-bottom-color: #eee;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .pl-3 {
  padding-left: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .pl-7 {
  padding-left: 48px!important;
}

.markdown-body .pl-8 {
  padding-left: 64px!important;
}

.markdown-body .pl-9 {
  padding-left: 80px!important;
}

.markdown-body .pl-10 {
  padding-left: 96px!important;
}

.markdown-body .pl-11 {
  padding-left: 112px!important;
}

.markdown-body .pl-12 {
  padding-left: 128px!important;
}

/*# sourceURL=webpack://./node_modules/github-markdown-css/github-markdown.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9naXRodWItbWFya2Rvd24tY3NzL2dpdGh1Yi1tYXJrZG93bi5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSwwQkFBMEI7RUFDMUIsMkRBQXF0RTtBQUN2dEU7O0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsa0JBQWtCO0VBQ2xCLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTs7Ozs7O0VBTUUsY0FBYztFQUNkLHNCQUFzQjtFQUN0QixrQkFBa0I7QUFDcEI7O0FBRUE7Ozs7OztFQU1FLHFCQUFxQjtBQUN2Qjs7QUFFQTs7Ozs7O0VBTUUsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsMEJBQTBCO0VBQzFCLDhCQUE4QjtFQUM5QixjQUFjO0VBQ2QsZ0JBQWdCO0VBQ2hCLGtJQUFrSTtFQUNsSSxlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7O0VBRUUsY0FBYztBQUNoQjs7QUFFQTs7RUFFRSxjQUFjO0FBQ2hCOztBQUVBOztFQUVFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTs7Ozs7OztFQU9FLGNBQWM7QUFDaEI7O0FBRUE7O0VBRUUsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7OztFQUdFLGNBQWM7RUFDZCxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFD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 */
  </style>
  <style>
  /**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

/*# sourceURL=webpack://./node_modules/prismjs/themes/prism.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9wcmlzbWpzL3RoZW1lcy9wcmlzbS5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7RUFJRTs7QUFFRjs7Q0FFQyxZQUFZO0NBQ1osZ0JBQWdCO0NBQ2hCLHdCQUF3QjtDQUN4QixzRUFBc0U7Q0FDdEUsY0FBYztDQUNkLGdCQUFnQjtDQUNoQixnQkFBZ0I7Q0FDaEIsb0JBQW9CO0NBQ3BCLGtCQUFrQjtDQUNsQixpQkFBaUI7Q0FDakIsZ0JBQWdCOztDQUVoQixnQkFBZ0I7Q0FDaEIsY0FBYztDQUNkLFdBQVc7O0NBRVgscUJBQXFCO0NBQ3JCLGtCQUFrQjtDQUNsQixpQkFBaUI7Q0FDakIsYUFBYTtBQUNkOztBQUVBOztDQUVDLGlCQUFpQjtDQUNqQixtQkFBbUI7QUFDcEI7O0FBRUE7O0NBRUMsaUJBQWlCO0NBQ2pCLG1CQUFtQjtBQUNwQjs7QUFFQTtDQUNDOztFQUVDLGlCQUFpQjtDQUNsQjtBQUNEOztBQUVBLGdCQUFnQjtBQUNoQjtDQUNDLFlBQVk7Q0FDWixjQUFjO0NBQ2QsY0FBYztBQUNmOztBQUVBOztDQUVDLG1CQUFtQjtBQUNwQjs7QUFFQSxnQkFBZ0I7QUFDaEI7Q0FDQyxhQUFhO0NBQ2IsbUJBQW1CO0NBQ25CLG1CQUFtQjtBQUNwQjs7QUFFQTs7OztDQUlDLGdCQUFnQjtBQUNqQjs7QUFFQTtDQUNDLFdBQVc7QUFDWjs7QUFFQTtDQUNDLFdBQVc7QUFDWjs7QUFFQTs7Ozs7OztDQU9DLFdBQVc7QUFDWjs7QUFFQTs7Ozs7O0NBTUMsV0FBVztBQUNaOztBQUVBOzs7OztDQUtDLGNBQWM7Q0FDZCxvRUFBb0U7Q0FDcEUsaUNBQWlDO0FBQ2xDOztBQUVBOzs7Q0FHQyxXQUFXO0FBQ1o7O0FBRUE7O0NBRUMsY0FBYztBQUNmOztBQUVBOzs7Q0FHQyxXQUFXO0FBQ1o7O0FBRUE7O0NBRUMsaUJBQWlCO0FBQ2xCO0FBQ0E7Q0FDQyxrQkFBa0I7QUFDbkI7O0FBRUE7Q0FDQyxZQUFZO0FBQ2IiLCJzb3VyY2VSb290IjoiIn0= */
  </style>
  <style>
  /* stylelint-disable font-family-no-missing-generic-family-keyword */
@font-face {
  font-family: 'KaTeX_AMS';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_AMS-Regular.73ea273a.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_AMS-Regular.d562e886.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_AMS-Regular.853be924.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Caligraphic';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Caligraphic-Bold.a1abf90d.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Caligraphic-Bold.d757c535.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Caligraphic-Bold.7489a2fb.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Caligraphic';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Caligraphic-Regular.d6484fce.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Caligraphic-Regular.db074fa2.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Caligraphic-Regular.7e873d38.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Fraktur';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Fraktur-Bold.931d67ea.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Fraktur-Bold.354501ba.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Fraktur-Bold.4c761b37.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Fraktur';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Fraktur-Regular.172d3529.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Fraktur-Regular.6fdf0ac5.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Fraktur-Regular.ed305b54.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Main';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Bold.39890742.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Bold.0c3b8929.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Bold.8169508b.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Main';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-BoldItalic.20f389c4.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-BoldItalic.428978dc.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-BoldItalic.828abcb2.ttf) format('truetype');
  font-weight: bold;
  font-style: italic;
}
@font-face {
  font-family: 'KaTeX_Main';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Italic.fe2176f7.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Italic.fd947498.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Italic.fa675e5e.ttf) format('truetype');
  font-weight: normal;
  font-style: italic;
}
@font-face {
  font-family: 'KaTeX_Main';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Regular.f650f111.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Regular.4f35fbcc.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Main-Regular.9eba1d77.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Math';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Math-BoldItalic.dcbcbd93.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Math-BoldItalic.3f07ed67.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Math-BoldItalic.bf2d440b.ttf) format('truetype');
  font-weight: bold;
  font-style: italic;
}
@font-face {
  font-family: 'KaTeX_Math';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Math-Italic.6d3d25f4.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Math-Italic.96759856.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Math-Italic.8a5f9363.ttf) format('truetype');
  font-weight: normal;
  font-style: italic;
}
@font-face {
  font-family: 'KaTeX_SansSerif';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Bold.95591a92.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Bold.b9cd458a.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Bold.5b49f499.ttf) format('truetype');
  font-weight: bold;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_SansSerif';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Italic.7d393d38.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Italic.8d593cfa.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Italic.b257a18c.ttf) format('truetype');
  font-weight: normal;
  font-style: italic;
}
@font-face {
  font-family: 'KaTeX_SansSerif';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Regular.cd5e231e.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Regular.02271ec5.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_SansSerif-Regular.2f7bc363.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Script';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Script-Regular.c81d1b2a.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Script-Regular.073b3402.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Script-Regular.fc9ba524.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Size1';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size1-Regular.6eec866c.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size1-Regular.0108e89c.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size1-Regular.6de7d4b5.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Size2';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size2-Regular.2960900c.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size2-Regular.3a99e70a.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size2-Regular.57f5c183.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Size3';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size3-Regular.e1951519.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size3-Regular.7947224e.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size3-Regular.8d6b6822.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Size4';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size4-Regular.e418bf25.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size4-Regular.aeffd802.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Size4-Regular.4ad7c7e8.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
@font-face {
  font-family: 'KaTeX_Typewriter';
  src: url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Typewriter-Regular.c295e7f7.woff2) format('woff2'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Typewriter-Regular.4c6b94fd.woff) format('woff'), url(file:///D:/MarkText/resources/app.asar/dist/electron/fonts/KaTeX_Typewriter-Regular.c5c02d76.ttf) format('truetype');
  font-weight: normal;
  font-style: normal;
}
.katex {
  font: normal 1.21em KaTeX_Main, Times New Roman, serif;
  line-height: 1.2;
  text-indent: 0;
  text-rendering: auto;
}
.katex * {
  -ms-high-contrast-adjust: none !important;
  border-color: currentColor;
}
.katex .katex-version::after {
  content: "0.15.2";
}
.katex .katex-mathml {
  /* Accessibility hack to only show to screen readers
         Found at: http://a11yproject.com/posts/how-to-hide-content/ */
  position: absolute;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 0;
  border: 0;
  height: 1px;
  width: 1px;
  overflow: hidden;
}
.katex .katex-html {
  /* \newline is an empty block at top level, between .base elements */
}
.katex .katex-html > .newline {
  display: block;
}
.katex .base {
  position: relative;
  display: inline-block;
  white-space: nowrap;
  width: -webkit-min-content;
  width: -moz-min-content;
  width: min-content;
}
.katex .strut {
  display: inline-block;
}
.katex .textbf {
  font-weight: bold;
}
.katex .textit {
  font-style: italic;
}
.katex .textrm {
  font-family: KaTeX_Main;
}
.katex .textsf {
  font-family: KaTeX_SansSerif;
}
.katex .texttt {
  font-family: KaTeX_Typewriter;
}
.katex .mathnormal {
  font-family: KaTeX_Math;
  font-style: italic;
}
.katex .mathit {
  font-family: KaTeX_Main;
  font-style: italic;
}
.katex .mathrm {
  font-style: normal;
}
.katex .mathbf {
  font-family: KaTeX_Main;
  font-weight: bold;
}
.katex .boldsymbol {
  font-family: KaTeX_Math;
  font-weight: bold;
  font-style: italic;
}
.katex .amsrm {
  font-family: KaTeX_AMS;
}
.katex .mathbb,
.katex .textbb {
  font-family: KaTeX_AMS;
}
.katex .mathcal {
  font-family: KaTeX_Caligraphic;
}
.katex .mathfrak,
.katex .textfrak {
  font-family: KaTeX_Fraktur;
}
.katex .mathtt {
  font-family: KaTeX_Typewriter;
}
.katex .mathscr,
.katex .textscr {
  font-family: KaTeX_Script;
}
.katex .mathsf,
.katex .textsf {
  font-family: KaTeX_SansSerif;
}
.katex .mathboldsf,
.katex .textboldsf {
  font-family: KaTeX_SansSerif;
  font-weight: bold;
}
.katex .mathitsf,
.katex .textitsf {
  font-family: KaTeX_SansSerif;
  font-style: italic;
}
.katex .mainrm {
  font-family: KaTeX_Main;
  font-style: normal;
}
.katex .vlist-t {
  display: inline-table;
  table-layout: fixed;
  border-collapse: collapse;
}
.katex .vlist-r {
  display: table-row;
}
.katex .vlist {
  display: table-cell;
  vertical-align: bottom;
  position: relative;
}
.katex .vlist > span {
  display: block;
  height: 0;
  position: relative;
}
.katex .vlist > span > span {
  display: inline-block;
}
.katex .vlist > span > .pstrut {
  overflow: hidden;
  width: 0;
}
.katex .vlist-t2 {
  margin-right: -2px;
}
.katex .vlist-s {
  display: table-cell;
  vertical-align: bottom;
  font-size: 1px;
  width: 2px;
  min-width: 2px;
}
.katex .vbox {
  display: inline-flex;
  flex-direction: column;
  align-items: baseline;
}
.katex .hbox {
  display: inline-flex;
  flex-direction: row;
  width: 100%;
}
.katex .thinbox {
  display: inline-flex;
  flex-direction: row;
  width: 0;
  max-width: 0;
}
.katex .msupsub {
  text-align: left;
}
.katex .mfrac > span > span {
  text-align: center;
}
.katex .mfrac .frac-line {
  display: inline-block;
  width: 100%;
  border-bottom-style: solid;
}
.katex .mfrac .frac-line,
.katex .overline .overline-line,
.katex .underline .underline-line,
.katex .hline,
.katex .hdashline,
.katex .rule {
  min-height: 1px;
}
.katex .mspace {
  display: inline-block;
}
.katex .llap,
.katex .rlap,
.katex .clap {
  width: 0;
  position: relative;
}
.katex .llap > .inner,
.katex .rlap > .inner,
.katex .clap > .inner {
  position: absolute;
}
.katex .llap > .fix,
.katex .rlap > .fix,
.katex .clap > .fix {
  display: inline-block;
}
.katex .llap > .inner {
  right: 0;
}
.katex .rlap > .inner,
.katex .clap > .inner {
  left: 0;
}
.katex .clap > .inner > span {
  margin-left: -50%;
  margin-right: 50%;
}
.katex .rule {
  display: inline-block;
  border: solid 0;
  position: relative;
}
.katex .overline .overline-line,
.katex .underline .underline-line,
.katex .hline {
  display: inline-block;
  width: 100%;
  border-bottom-style: solid;
}
.katex .hdashline {
  display: inline-block;
  width: 100%;
  border-bottom-style: dashed;
}
.katex .sqrt > .root {
  /* These values are taken from the definition of `\r@@t`,
             `\mkern 5mu` and `\mkern -10mu`. */
  margin-left: 0.27777778em;
  margin-right: -0.55555556em;
}
.katex .sizing.reset-size1.size1,
.katex .fontsize-ensurer.reset-size1.size1 {
  font-size: 1em;
}
.katex .sizing.reset-size1.size2,
.katex .fontsize-ensurer.reset-size1.size2 {
  font-size: 1.2em;
}
.katex .sizing.reset-size1.size3,
.katex .fontsize-ensurer.reset-size1.size3 {
  font-size: 1.4em;
}
.katex .sizing.reset-size1.size4,
.katex .fontsize-ensurer.reset-size1.size4 {
  font-size: 1.6em;
}
.katex .sizing.reset-size1.size5,
.katex .fontsize-ensurer.reset-size1.size5 {
  font-size: 1.8em;
}
.katex .sizing.reset-size1.size6,
.katex .fontsize-ensurer.reset-size1.size6 {
  font-size: 2em;
}
.katex .sizing.reset-size1.size7,
.katex .fontsize-ensurer.reset-size1.size7 {
  font-size: 2.4em;
}
.katex .sizing.reset-size1.size8,
.katex .fontsize-ensurer.reset-size1.size8 {
  font-size: 2.88em;
}
.katex .sizing.reset-size1.size9,
.katex .fontsize-ensurer.reset-size1.size9 {
  font-size: 3.456em;
}
.katex .sizing.reset-size1.size10,
.katex .fontsize-ensurer.reset-size1.size10 {
  font-size: 4.148em;
}
.katex .sizing.reset-size1.size11,
.katex .fontsize-ensurer.reset-size1.size11 {
  font-size: 4.976em;
}
.katex .sizing.reset-size2.size1,
.katex .fontsize-ensurer.reset-size2.size1 {
  font-size: 0.83333333em;
}
.katex .sizing.reset-size2.size2,
.katex .fontsize-ensurer.reset-size2.size2 {
  font-size: 1em;
}
.katex .sizing.reset-size2.size3,
.katex .fontsize-ensurer.reset-size2.size3 {
  font-size: 1.16666667em;
}
.katex .sizing.reset-size2.size4,
.katex .fontsize-ensurer.reset-size2.size4 {
  font-size: 1.33333333em;
}
.katex .sizing.reset-size2.size5,
.katex .fontsize-ensurer.reset-size2.size5 {
  font-size: 1.5em;
}
.katex .sizing.reset-size2.size6,
.katex .fontsize-ensurer.reset-size2.size6 {
  font-size: 1.66666667em;
}
.katex .sizing.reset-size2.size7,
.katex .fontsize-ensurer.reset-size2.size7 {
  font-size: 2em;
}
.katex .sizing.reset-size2.size8,
.katex .fontsize-ensurer.reset-size2.size8 {
  font-size: 2.4em;
}
.katex .sizing.reset-size2.size9,
.katex .fontsize-ensurer.reset-size2.size9 {
  font-size: 2.88em;
}
.katex .sizing.reset-size2.size10,
.katex .fontsize-ensurer.reset-size2.size10 {
  font-size: 3.45666667em;
}
.katex .sizing.reset-size2.size11,
.katex .fontsize-ensurer.reset-size2.size11 {
  font-size: 4.14666667em;
}
.katex .sizing.reset-size3.size1,
.katex .fontsize-ensurer.reset-size3.size1 {
  font-size: 0.71428571em;
}
.katex .sizing.reset-size3.size2,
.katex .fontsize-ensurer.reset-size3.size2 {
  font-size: 0.85714286em;
}
.katex .sizing.reset-size3.size3,
.katex .fontsize-ensurer.reset-size3.size3 {
  font-size: 1em;
}
.katex .sizing.reset-size3.size4,
.katex .fontsize-ensurer.reset-size3.size4 {
  font-size: 1.14285714em;
}
.katex .sizing.reset-size3.size5,
.katex .fontsize-ensurer.reset-size3.size5 {
  font-size: 1.28571429em;
}
.katex .sizing.reset-size3.size6,
.katex .fontsize-ensurer.reset-size3.size6 {
  font-size: 1.42857143em;
}
.katex .sizing.reset-size3.size7,
.katex .fontsize-ensurer.reset-size3.size7 {
  font-size: 1.71428571em;
}
.katex .sizing.reset-size3.size8,
.katex .fontsize-ensurer.reset-size3.size8 {
  font-size: 2.05714286em;
}
.katex .sizing.reset-size3.size9,
.katex .fontsize-ensurer.reset-size3.size9 {
  font-size: 2.46857143em;
}
.katex .sizing.reset-size3.size10,
.katex .fontsize-ensurer.reset-size3.size10 {
  font-size: 2.96285714em;
}
.katex .sizing.reset-size3.size11,
.katex .fontsize-ensurer.reset-size3.size11 {
  font-size: 3.55428571em;
}
.katex .sizing.reset-size4.size1,
.katex .fontsize-ensurer.reset-size4.size1 {
  font-size: 0.625em;
}
.katex .sizing.reset-size4.size2,
.katex .fontsize-ensurer.reset-size4.size2 {
  font-size: 0.75em;
}
.katex .sizing.reset-size4.size3,
.katex .fontsize-ensurer.reset-size4.size3 {
  font-size: 0.875em;
}
.katex .sizing.reset-size4.size4,
.katex .fontsize-ensurer.reset-size4.size4 {
  font-size: 1em;
}
.katex .sizing.reset-size4.size5,
.katex .fontsize-ensurer.reset-size4.size5 {
  font-size: 1.125em;
}
.katex .sizing.reset-size4.size6,
.katex .fontsize-ensurer.reset-size4.size6 {
  font-size: 1.25em;
}
.katex .sizing.reset-size4.size7,
.katex .fontsize-ensurer.reset-size4.size7 {
  font-size: 1.5em;
}
.katex .sizing.reset-size4.size8,
.katex .fontsize-ensurer.reset-size4.size8 {
  font-size: 1.8em;
}
.katex .sizing.reset-size4.size9,
.katex .fontsize-ensurer.reset-size4.size9 {
  font-size: 2.16em;
}
.katex .sizing.reset-size4.size10,
.katex .fontsize-ensurer.reset-size4.size10 {
  font-size: 2.5925em;
}
.katex .sizing.reset-size4.size11,
.katex .fontsize-ensurer.reset-size4.size11 {
  font-size: 3.11em;
}
.katex .sizing.reset-size5.size1,
.katex .fontsize-ensurer.reset-size5.size1 {
  font-size: 0.55555556em;
}
.katex .sizing.reset-size5.size2,
.katex .fontsize-ensurer.reset-size5.size2 {
  font-size: 0.66666667em;
}
.katex .sizing.reset-size5.size3,
.katex .fontsize-ensurer.reset-size5.size3 {
  font-size: 0.77777778em;
}
.katex .sizing.reset-size5.size4,
.katex .fontsize-ensurer.reset-size5.size4 {
  font-size: 0.88888889em;
}
.katex .sizing.reset-size5.size5,
.katex .fontsize-ensurer.reset-size5.size5 {
  font-size: 1em;
}
.katex .sizing.reset-size5.size6,
.katex .fontsize-ensurer.reset-size5.size6 {
  font-size: 1.11111111em;
}
.katex .sizing.reset-size5.size7,
.katex .fontsize-ensurer.reset-size5.size7 {
  font-size: 1.33333333em;
}
.katex .sizing.reset-size5.size8,
.katex .fontsize-ensurer.reset-size5.size8 {
  font-size: 1.6em;
}
.katex .sizing.reset-size5.size9,
.katex .fontsize-ensurer.reset-size5.size9 {
  font-size: 1.92em;
}
.katex .sizing.reset-size5.size10,
.katex .fontsize-ensurer.reset-size5.size10 {
  font-size: 2.30444444em;
}
.katex .sizing.reset-size5.size11,
.katex .fontsize-ensurer.reset-size5.size11 {
  font-size: 2.76444444em;
}
.katex .sizing.reset-size6.size1,
.katex .fontsize-ensurer.reset-size6.size1 {
  font-size: 0.5em;
}
.katex .sizing.reset-size6.size2,
.katex .fontsize-ensurer.reset-size6.size2 {
  font-size: 0.6em;
}
.katex .sizing.reset-size6.size3,
.katex .fontsize-ensurer.reset-size6.size3 {
  font-size: 0.7em;
}
.katex .sizing.reset-size6.size4,
.katex .fontsize-ensurer.reset-size6.size4 {
  font-size: 0.8em;
}
.katex .sizing.reset-size6.size5,
.katex .fontsize-ensurer.reset-size6.size5 {
  font-size: 0.9em;
}
.katex .sizing.reset-size6.size6,
.katex .fontsize-ensurer.reset-size6.size6 {
  font-size: 1em;
}
.katex .sizing.reset-size6.size7,
.katex .fontsize-ensurer.reset-size6.size7 {
  font-size: 1.2em;
}
.katex .sizing.reset-size6.size8,
.katex .fontsize-ensurer.reset-size6.size8 {
  font-size: 1.44em;
}
.katex .sizing.reset-size6.size9,
.katex .fontsize-ensurer.reset-size6.size9 {
  font-size: 1.728em;
}
.katex .sizing.reset-size6.size10,
.katex .fontsize-ensurer.reset-size6.size10 {
  font-size: 2.074em;
}
.katex .sizing.reset-size6.size11,
.katex .fontsize-ensurer.reset-size6.size11 {
  font-size: 2.488em;
}
.katex .sizing.reset-size7.size1,
.katex .fontsize-ensurer.reset-size7.size1 {
  font-size: 0.41666667em;
}
.katex .sizing.reset-size7.size2,
.katex .fontsize-ensurer.reset-size7.size2 {
  font-size: 0.5em;
}
.katex .sizing.reset-size7.size3,
.katex .fontsize-ensurer.reset-size7.size3 {
  font-size: 0.58333333em;
}
.katex .sizing.reset-size7.size4,
.katex .fontsize-ensurer.reset-size7.size4 {
  font-size: 0.66666667em;
}
.katex .sizing.reset-size7.size5,
.katex .fontsize-ensurer.reset-size7.size5 {
  font-size: 0.75em;
}
.katex .sizing.reset-size7.size6,
.katex .fontsize-ensurer.reset-size7.size6 {
  font-size: 0.83333333em;
}
.katex .sizing.reset-size7.size7,
.katex .fontsize-ensurer.reset-size7.size7 {
  font-size: 1em;
}
.katex .sizing.reset-size7.size8,
.katex .fontsize-ensurer.reset-size7.size8 {
  font-size: 1.2em;
}
.katex .sizing.reset-size7.size9,
.katex .fontsize-ensurer.reset-size7.size9 {
  font-size: 1.44em;
}
.katex .sizing.reset-size7.size10,
.katex .fontsize-ensurer.reset-size7.size10 {
  font-size: 1.72833333em;
}
.katex .sizing.reset-size7.size11,
.katex .fontsize-ensurer.reset-size7.size11 {
  font-size: 2.07333333em;
}
.katex .sizing.reset-size8.size1,
.katex .fontsize-ensurer.reset-size8.size1 {
  font-size: 0.34722222em;
}
.katex .sizing.reset-size8.size2,
.katex .fontsize-ensurer.reset-size8.size2 {
  font-size: 0.41666667em;
}
.katex .sizing.reset-size8.size3,
.katex .fontsize-ensurer.reset-size8.size3 {
  font-size: 0.48611111em;
}
.katex .sizing.reset-size8.size4,
.katex .fontsize-ensurer.reset-size8.size4 {
  font-size: 0.55555556em;
}
.katex .sizing.reset-size8.size5,
.katex .fontsize-ensurer.reset-size8.size5 {
  font-size: 0.625em;
}
.katex .sizing.reset-size8.size6,
.katex .fontsize-ensurer.reset-size8.size6 {
  font-size: 0.69444444em;
}
.katex .sizing.reset-size8.size7,
.katex .fontsize-ensurer.reset-size8.size7 {
  font-size: 0.83333333em;
}
.katex .sizing.reset-size8.size8,
.katex .fontsize-ensurer.reset-size8.size8 {
  font-size: 1em;
}
.katex .sizing.reset-size8.size9,
.katex .fontsize-ensurer.reset-size8.size9 {
  font-size: 1.2em;
}
.katex .sizing.reset-size8.size10,
.katex .fontsize-ensurer.reset-size8.size10 {
  font-size: 1.44027778em;
}
.katex .sizing.reset-size8.size11,
.katex .fontsize-ensurer.reset-size8.size11 {
  font-size: 1.72777778em;
}
.katex .sizing.reset-size9.size1,
.katex .fontsize-ensurer.reset-size9.size1 {
  font-size: 0.28935185em;
}
.katex .sizing.reset-size9.size2,
.katex .fontsize-ensurer.reset-size9.size2 {
  font-size: 0.34722222em;
}
.katex .sizing.reset-size9.size3,
.katex .fontsize-ensurer.reset-size9.size3 {
  font-size: 0.40509259em;
}
.katex .sizing.reset-size9.size4,
.katex .fontsize-ensurer.reset-size9.size4 {
  font-size: 0.46296296em;
}
.katex .sizing.reset-size9.size5,
.katex .fontsize-ensurer.reset-size9.size5 {
  font-size: 0.52083333em;
}
.katex .sizing.reset-size9.size6,
.katex .fontsize-ensurer.reset-size9.size6 {
  font-size: 0.5787037em;
}
.katex .sizing.reset-size9.size7,
.katex .fontsize-ensurer.reset-size9.size7 {
  font-size: 0.69444444em;
}
.katex .sizing.reset-size9.size8,
.katex .fontsize-ensurer.reset-size9.size8 {
  font-size: 0.83333333em;
}
.katex .sizing.reset-size9.size9,
.katex .fontsize-ensurer.reset-size9.size9 {
  font-size: 1em;
}
.katex .sizing.reset-size9.size10,
.katex .fontsize-ensurer.reset-size9.size10 {
  font-size: 1.20023148em;
}
.katex .sizing.reset-size9.size11,
.katex .fontsize-ensurer.reset-size9.size11 {
  font-size: 1.43981481em;
}
.katex .sizing.reset-size10.size1,
.katex .fontsize-ensurer.reset-size10.size1 {
  font-size: 0.24108004em;
}
.katex .sizing.reset-size10.size2,
.katex .fontsize-ensurer.reset-size10.size2 {
  font-size: 0.28929605em;
}
.katex .sizing.reset-size10.size3,
.katex .fontsize-ensurer.reset-size10.size3 {
  font-size: 0.33751205em;
}
.katex .sizing.reset-size10.size4,
.katex .fontsize-ensurer.reset-size10.size4 {
  font-size: 0.38572806em;
}
.katex .sizing.reset-size10.size5,
.katex .fontsize-ensurer.reset-size10.size5 {
  font-size: 0.43394407em;
}
.katex .sizing.reset-size10.size6,
.katex .fontsize-ensurer.reset-size10.size6 {
  font-size: 0.48216008em;
}
.katex .sizing.reset-size10.size7,
.katex .fontsize-ensurer.reset-size10.size7 {
  font-size: 0.57859209em;
}
.katex .sizing.reset-size10.size8,
.katex .fontsize-ensurer.reset-size10.size8 {
  font-size: 0.69431051em;
}
.katex .sizing.reset-size10.size9,
.katex .fontsize-ensurer.reset-size10.size9 {
  font-size: 0.83317261em;
}
.katex .sizing.reset-size10.size10,
.katex .fontsize-ensurer.reset-size10.size10 {
  font-size: 1em;
}
.katex .sizing.reset-size10.size11,
.katex .fontsize-ensurer.reset-size10.size11 {
  font-size: 1.19961427em;
}
.katex .sizing.reset-size11.size1,
.katex .fontsize-ensurer.reset-size11.size1 {
  font-size: 0.20096463em;
}
.katex .sizing.reset-size11.size2,
.katex .fontsize-ensurer.reset-size11.size2 {
  font-size: 0.24115756em;
}
.katex .sizing.reset-size11.size3,
.katex .fontsize-ensurer.reset-size11.size3 {
  font-size: 0.28135048em;
}
.katex .sizing.reset-size11.size4,
.katex .fontsize-ensurer.reset-size11.size4 {
  font-size: 0.32154341em;
}
.katex .sizing.reset-size11.size5,
.katex .fontsize-ensurer.reset-size11.size5 {
  font-size: 0.36173633em;
}
.katex .sizing.reset-size11.size6,
.katex .fontsize-ensurer.reset-size11.size6 {
  font-size: 0.40192926em;
}
.katex .sizing.reset-size11.size7,
.katex .fontsize-ensurer.reset-size11.size7 {
  font-size: 0.48231511em;
}
.katex .sizing.reset-size11.size8,
.katex .fontsize-ensurer.reset-size11.size8 {
  font-size: 0.57877814em;
}
.katex .sizing.reset-size11.size9,
.katex .fontsize-ensurer.reset-size11.size9 {
  font-size: 0.69453376em;
}
.katex .sizing.reset-size11.size10,
.katex .fontsize-ensurer.reset-size11.size10 {
  font-size: 0.83360129em;
}
.katex .sizing.reset-size11.size11,
.katex .fontsize-ensurer.reset-size11.size11 {
  font-size: 1em;
}
.katex .delimsizing.size1 {
  font-family: KaTeX_Size1;
}
.katex .delimsizing.size2 {
  font-family: KaTeX_Size2;
}
.katex .delimsizing.size3 {
  font-family: KaTeX_Size3;
}
.katex .delimsizing.size4 {
  font-family: KaTeX_Size4;
}
.katex .delimsizing.mult .delim-size1 > span {
  font-family: KaTeX_Size1;
}
.katex .delimsizing.mult .delim-size4 > span {
  font-family: KaTeX_Size4;
}
.katex .nulldelimiter {
  display: inline-block;
  width: 0.12em;
}
.katex .delimcenter {
  position: relative;
}
.katex .op-symbol {
  position: relative;
}
.katex .op-symbol.small-op {
  font-family: KaTeX_Size1;
}
.katex .op-symbol.large-op {
  font-family: KaTeX_Size2;
}
.katex .op-limits > .vlist-t {
  text-align: center;
}
.katex .accent > .vlist-t {
  text-align: center;
}
.katex .accent .accent-body {
  position: relative;
}
.katex .accent .accent-body:not(.accent-full) {
  width: 0;
}
.katex .overlay {
  display: block;
}
.katex .mtable .vertical-separator {
  display: inline-block;
  min-width: 1px;
}
.katex .mtable .arraycolsep {
  display: inline-block;
}
.katex .mtable .col-align-c > .vlist-t {
  text-align: center;
}
.katex .mtable .col-align-l > .vlist-t {
  text-align: left;
}
.katex .mtable .col-align-r > .vlist-t {
  text-align: right;
}
.katex .svg-align {
  text-align: left;
}
.katex svg {
  display: block;
  position: absolute;
  width: 100%;
  height: inherit;
  fill: currentColor;
  stroke: currentColor;
  fill-rule: nonzero;
  fill-opacity: 1;
  stroke-width: 1;
  stroke-linecap: butt;
  stroke-linejoin: miter;
  stroke-miterlimit: 4;
  stroke-dasharray: none;
  stroke-dashoffset: 0;
  stroke-opacity: 1;
}
.katex svg path {
  stroke: none;
}
.katex img {
  border-style: none;
  min-width: 0;
  min-height: 0;
  max-width: none;
  max-height: none;
}
.katex .stretchy {
  width: 100%;
  display: block;
  position: relative;
  overflow: hidden;
}
.katex .stretchy::before,
.katex .stretchy::after {
  content: "";
}
.katex .hide-tail {
  width: 100%;
  position: relative;
  overflow: hidden;
}
.katex .halfarrow-left {
  position: absolute;
  left: 0;
  width: 50.2%;
  overflow: hidden;
}
.katex .halfarrow-right {
  position: absolute;
  right: 0;
  width: 50.2%;
  overflow: hidden;
}
.katex .brace-left {
  position: absolute;
  left: 0;
  width: 25.1%;
  overflow: hidden;
}
.katex .brace-center {
  position: absolute;
  left: 25%;
  width: 50%;
  overflow: hidden;
}
.katex .brace-right {
  position: absolute;
  right: 0;
  width: 25.1%;
  overflow: hidden;
}
.katex .x-arrow-pad {
  padding: 0 0.5em;
}
.katex .cd-arrow-pad {
  padding: 0 0.55556em 0 0.27778em;
}
.katex .x-arrow,
.katex .mover,
.katex .munder {
  text-align: center;
}
.katex .boxpad {
  padding: 0 0.3em;
}
.katex .fbox,
.katex .fcolorbox {
  box-sizing: border-box;
  border: 0.04em solid;
}
.katex .cancel-pad {
  padding: 0 0.2em;
}
.katex .cancel-lap {
  margin-left: -0.2em;
  margin-right: -0.2em;
}
.katex .sout {
  border-bottom-style: solid;
  border-bottom-width: 0.08em;
}
.katex .angl {
  box-sizing: border-box;
  border-top: 0.049em solid;
  border-right: 0.049em solid;
  margin-right: 0.03889em;
}
.katex .anglpad {
  padding: 0 0.03889em;
}
.katex .eqn-num::before {
  counter-increment: katexEqnNo;
  content: "(" counter(katexEqnNo) ")";
}
.katex .mml-eqn-num::before {
  counter-increment: mmlEqnNo;
  content: "(" counter(mmlEqnNo) ")";
}
.katex .mtr-glue {
  width: 50%;
}
.katex .cd-vert-arrow {
  display: inline-block;
  position: relative;
}
.katex .cd-label-left {
  display: inline-block;
  position: absolute;
  right: calc(50% + 0.3em);
  text-align: left;
}
.katex .cd-label-right {
  display: inline-block;
  position: absolute;
  left: calc(50% + 0.3em);
  text-align: right;
}
.katex-display {
  display: block;
  margin: 1em 0;
  text-align: center;
}
.katex-display > .katex {
  display: block;
  text-align: center;
  white-space: nowrap;
}
.katex-display > .katex > .katex-html {
  display: block;
  position: relative;
}
.katex-display > .katex > .katex-html > .tag {
  position: absolute;
  right: 0;
}
.katex-display.leqno > .katex > .katex-html > .tag {
  left: 0;
  right: auto;
}
.katex-display.fleqn > .katex {
  text-align: left;
  padding-left: 2em;
}
body {
  counter-reset: katexEqnNo mmlEqnNo;
}


/*# sourceURL=webpack://./node_modules/katex/dist/katex.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9rYXRleC9kaXN0L2thdGV4LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvRUFBb0U7QUFDcEU7RUFDRSx3QkFBd0I7RUFDeEIsZ0xBQThKO0VBQzlKLG1CQUFtQjtFQUNuQixrQkFBa0I7QUFDcEI7QUFDQTtFQUNFLGdDQUFnQztFQUNoQyxnTEFBNks7RUFDN0ssaUJBQWlCO0VBQ2pCLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsZ0NBQWdDO0VBQ2hDLGdMQUFzTDtFQUN0TCxtQkFBbUI7RUFDbkIsa0JBQWtCO0FBQ3BCO0FBQ0E7RUFDRSw0QkFBNEI7RUFDNUIsa0xBQWlLO0VBQ2pLLGlCQUFpQjtFQUNqQixrQkFBa0I7QUFDcEI7QUFDQTtFQUNFLDRCQUE0QjtFQUM1QixtTEFBMEs7RUFDMUssbUJBQW1CO0VBQ25CLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UseUJBQXlCO0VBQ3pCLG1MQUF3SjtFQUN4SixpQkFBaUI7RUFDakIsa0JBQWtCO0FBQ3BCO0FBQ0E7RUFDRSx5QkFBeUI7RUFDekIsbUxBQTBLO0VBQzFLLGlCQUFpQjtFQUNqQixrQkFBa0I7QUFDcEI7QUFDQTtFQUNFLHlCQUF5QjtFQUN6QixtTEFBOEo7RUFDOUosbUJBQW1CO0VBQ25CLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UseUJBQXlCO0VBQ3pCLG1MQUFpSztFQUNqSyxtQkFBbUI7RUFDbkIsa0JBQWtCO0FBQ3BCO0FBQ0E7RUFDRSx5QkFBeUI7RUFDekIsbUxBQTBLO0VBQzFLLGlCQUFpQjtFQUNqQixrQkFBa0I7QUFDcEI7QUFDQTtFQUNFLHlCQUF5QjtFQUN6QixtTEFBOEo7RUFDOUosbUJBQW1CO0VBQ25CLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsOEJBQThCO0VBQzlCLG1MQUF1SztFQUN2SyxpQkFBaUI7RUFDakIsa0JBQWtCO0FBQ3BCO0FBQ0E7RUFDRSw4QkFBOEI7RUFDOUIsbUxBQTZLO0VBQzdLLG1CQUFtQjtFQUNu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 */
  </style>
  <style>
    .markdown-body {
      font-family: -apple-system,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }

    @media not print {
      .markdown-body {
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    }

    .hf-container {
      color: #24292e;
      line-height: 1.3;
    }

    .markdown-body .highlight pre,
    .markdown-body pre {
      white-space: pre-wrap;
    }
    .markdown-body table {
      display: table;
    }
    .markdown-body img[data-align="center"] {
      display: block;
      margin: 0 auto;
    }
    .markdown-body img[data-align="right"] {
      display: block;
      margin: 0 0 0 auto;
    }
    .markdown-body li.task-list-item {
      list-style-type: none;
    }
    .markdown-body li > [type=checkbox] {
      margin: 0 0 0 -1.3em;
    }
    .markdown-body input[type="checkbox"] ~ p {
      margin-top: 0;
      display: inline-block;
    }
    .markdown-body ol ol,
    .markdown-body ul ol {
      list-style-type: decimal;
    }
    .markdown-body ol ol ol,
    .markdown-body ol ul ol,
    .markdown-body ul ol ol,
    .markdown-body ul ul ol {
      list-style-type: decimal;
    }
  </style>
  <style>.markdown-body a.footnote-ref {
  text-decoration: none;
}

.footnotes {
  font-size: .85em;
  opacity: .8;
}

.footnotes li[role="doc-endnote"] {
  position: relative;
}

.footnotes .footnote-back {
  position: absolute;
  font-family: initial;
  top: .2em;
  right: 1em;
  text-decoration: none;
}

.inline-math.invalid,
.multiple-math.invalid {
  color: rgb(255, 105, 105);
}

.toc-container {
  width: 100%;
}

.toc-container .toc-title {
  font-weight: 700;
  font-size: 1.2em;
  margin-bottom: 0;
}

.toc-container li,
.toc-container ul,
.toc-container ul li {
  list-style: none !important;
}

.toc-container > ul {
  padding-left: 0;
}

.toc-container ul li span {
  display : flex;
}

.toc-container ul li span a {
  color: inherit;
  text-decoration: none;
}
.toc-container ul li span a:hover {
  color: inherit;
  text-decoration: none;
}

.toc-container ul li span span.dots {
  flex: 1;
  height: 0.65em;
  margin: 0 10px;
  border-bottom: 2px dotted black;
}

/*# sourceURL=webpack://./src/muya/lib/assets/styles/exportStyle.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tdXlhL2xpYi9hc3NldHMvc3R5bGVzL2V4cG9ydFN0eWxlLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsb0JBQW9CO0VBQ3BCLFNBQVM7RUFDVCxVQUFVO0VBQ1YscUJBQXFCO0FBQ3ZCOztBQUVBOztFQUVFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCOztBQUVBOzs7RUFHRSwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7QUFDQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxPQUFPO0VBQ1AsY0FBYztFQUNkLGNBQWM7RUFDZCwrQkFBK0I7QUFDakMiLCJzb3VyY2VSb290IjoiIn0= */</style>
  <style>.markdown-body{}pre.front-matter{display:none!important;}</style>
</head>
<body>
  <article class="markdown-body"><h1 class="atx" id="fu740線上系統搭建文檔">FU740線上系統搭建文檔</h1>
<h3 class="atx" id="樹莓派">樹莓派</h3>
<h4 class="atx" id="0-安裝系統">0. 安裝系統</h4>
<p>從<a href="https://www.raspberrypi.org/">官網</a>下載相關軟件，點擊Computers-&gt;Software。    </p>
<p><img alt="" src="file:///C:/Users/user/Desktop/graduation-projects/Photo/image-20220307110441584.png"></p>
<p>進入頁面後，在「Install Raspberry Pi OS using Raspberry Pi Imager」標題下方，可以看到不同系統的下載連結(此處以Windows為例)，根據自己的系統點擊下載Imager的安裝檔案。下載完成後安裝即可。</p>
<img style="zoom:33%;" alt="image-20220307110734492" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307110734492.png" title="">

<p>將SD卡利用讀卡器連接到你的裝置上，並打開Raspberry Pi Imager。</p>
<img style="zoom: 67%;" alt="image-20220307111054624" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111054624.png" title="">

<p>先進行格式化。先點擊選擇操作系統，選擇擦除。</p>
<img style="zoom:50%;" alt="image-20220307111134506" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111134506.png" title="">

<img width="643" style="zoom: 150%;" alt="image-20220307111230129" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111230129.png" title="">

<p>然後選擇相應的SD卡</p>
<img width="644" alt="image-20220307111304955" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111304955.png" title="">

<p>點擊燒錄。</p>
<img style="zoom:67%;" alt="image-20220307111332730" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111332730.png" title="">

<p>點選"是"。</p>
<img style="zoom:67%;" alt="image-20220307111510682" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111510682.png" title="">

<p>等待擦除，擦除完畢後點擊繼續。</p>
<p><img style="zoom:67%;" alt="image-20220307111546906" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111546906.png" title=""><img style="zoom:67%;" alt="image-20220307111558570" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307111558570.png" title=""></p>
<p>此時可以安裝操作系統，重新選擇適合的操作系統，此處以安裝Ubuntu 20.04版本為例。</p>
<p><img style="zoom: 67%;" alt="image-20220318110625604" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318110625604.png" title=""><img style="zoom:67%;" alt="image-20220318110702110" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318110702110.png" title=""></p>
<p>或者可以在<a href="https://ubuntu.com/download/raspberry-pi">Install Ubuntu on a Raspberry Pi | Ubuntu</a> 下載合適的鏡像，下載完成後直接點擊利用Raspberry Pi Imager打開即可。</p>
<p><img style="zoom:67%;" alt="image-20220318135442873" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318135442873.png" title=""><img style="zoom:67%;" alt="image-20220318141237880" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318141237880.png" title=""></p>
<p>按照剛才的操作，重新選擇SD卡，並進行燒錄。</p>
<img style="zoom:67%;" alt="image-20220307113441090" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307113441090.png" title="">

<p>點擊燒錄，等待燒錄。安裝完成後把SD卡插到樹莓派上。</p>
<p><img style="zoom:67%;" alt="image-20220307113515341" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220307113515341.png" title=""><img style="zoom:67%;" alt="image-20220318142614259" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318142614259.png" title=""></p>
<h4 class="atx" id="1-啟動樹莓派">1. 啟動樹莓派</h4>
<p>對於開機設定，可以有兩種選擇</p>
<ol>
<li><p>如果有顯示器，直接接上，再接上電源線，鍵盤，鼠標等設備開機進行設置。</p>
</li>
<li><p>如果沒有顯示器，便需要使用ssh來連接，對於Ubuntu第一次ssh登陸，需要有特定的操作</p>
<ol>
<li><p>首先可以利用網線或者連接WIFI來讓樹莓派連上網絡，這裏是使用Windows台式機來作為初始連接，打開行動熱點頁面。</p>
<p><img alt="image-20220318144824343" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318144824343.png"></p>
</li>
<li><p>在SD卡的<code>/system-boot</code>分區裏打開網絡配置文件<code>network-config</code>(注意只有在初始boot時才可以使用此方法)</p>
<pre><code class="fenced-code-block"># This file contains a netplan-compatible configuration which cloud-init will
# apply on first-boot (note: it will *not* update the config after the first
# boot). Please refer to the cloud-init documentation and the netplan reference
# for full details:
#
# https://cloudinit.readthedocs.io/en/latest/topics/network-config.html
# https://cloudinit.readthedocs.io/en/latest/topics/network-config-format-v2.html
# https://netplan.io/reference
#
# Please note that the YAML format employed by this file is sensitive to
# differences in whitespace; if you are editing this file in an editor (like
# Notepad) which uses literal tabs, take care to only use spaces for
# indentation. See the following link for more details:
#
# https://en.wikipedia.org/wiki/YAML
#
# Some additional examples are commented out below

   version: 2
   ethernets:
     eth0:
       dhcp4: true
       optional: true
   #wifis:
   #  wlan0:
   #    dhcp4: true
   #    optional: true
   #    access-points:
   #      myhomewifi:
   #        password: "S3kr1t"
   #      myworkwifi:
   #        password: "correct battery horse staple"
   #      workssid:
   #        auth:
   #          key-management: eap
   #          method: peap
   #          identity: "me@example.com"
   #          password: "passw0rd"
   #          ca-certificate: /etc/my_ca.pem</code></pre>
<p>在最下方加入WiFi訊息，其中"wifi_name"為行動熱點的網絡名稱，"wifi_pwd"為行動熱點的網絡密碼。</p>
<pre><code class="fenced-code-block"> wifis:
     wlan0:
       dhcp4: true
       dhcp6: true
       optional: true
       access-points:
         "wifi_name":
           password: "wifi_pwd"</code></pre>
</li>
<li><p>配置用戶名。ubuntu 留有一组默认的用户名, 要求用户第一次登陆的时候改掉它. 但是第一次接通电源的时候是无法连接到 WiFi 的, 需要断电再上电. 此时通过 SSH 登陆会遇到问题 <code>passwd: Authentication token manipulation error</code>打开文件 <code>user-data</code>, 找到</p>
<pre><code class="fenced-code-block">chpasswd:
  expire: true
  list:
  - ubuntu:ubuntu</code></pre>
<p>把 <code>expire: true</code> 改为 <code>expire: false</code> 这样系统可以用这组默认用户名密码 <code>ubuntu:ubuntu</code> 登陆系统, 直到修改密码.</p>
</li>
<li><p>保存文件，弹出SD卡</p>
</li>
<li><p>把SD卡插入树莓派</p>
</li>
<li><p>接上电源</p>
</li>
<li><p>通过主机的热点界面观察树莓派是否接入</p>
<img style="zoom:67%;" alt="image-20220318145719233" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220318145719233.png" title="">
</li>
<li><p>然後可以通過ssh連接到樹莓派上，預設密碼為ubuntu</p>
<img style="zoom: 80%;" alt="image-20220322102855700" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220322102855700.png" title="">
</li>
<li><p>可以利用公鑰免密SSH登入</p>
<ol>
<li>在命行中輸入<code>ssh-keygen</code>，一直按<code>enter</code>即可。</li>
<li>利用<code>ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu@pi_ip</code>，上傳金鑰到樹莓派上。</li>
<li>然後在下次登陸時便不需要輸入密碼了。</li>
</ol>
</li>
</ol>
</li>
</ol>
<h4 class="atx" id="2-連接tsinghua-secure">2. 連接Tsinghua-Secure</h4>
<h5 class="atx" id="配置靜態ip">配置靜態IP</h5>
<p>   為了防止開機時IP可能會改變的情況，可以添加一個固定IP。</p>
<ol>
<li><p>修改dhcpcd設定，添加如下語句</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">vim</span> /etc/dhcpcd.conf</code></pre>
<pre><code class="fenced-code-block language-shell">interface wlan0
static <span class="token assign-left variable">ip_address</span><span class="token operator">=</span> YOUR_STATIC_IP
static <span class="token assign-left variable">routers</span><span class="token operator">=</span>YOUR_ROUTER_IP
static <span class="token assign-left variable">domain_name_servers</span><span class="token operator">=</span>YOUR_DNS</code></pre>
</li>
</ol>
<h5 class="atx" id="動態ip方法">動態IP方法</h5>
<p>如果網絡條件不允許把IP設成固定的，可以利用這個方法。</p>
<p>為了能夠得知設備更換WiFi後的IP地址，撰寫一個簡單的開機發IP地址到郵件的腳本，參考[網址](<a href="https://shumeipai.nxez.com/2020/01/02/send-email-raspberry-pi-ip-with-python.html">使用 Python 将树莓派的 IP 发到邮箱 | 树莓派实验室 (nxez.com)</a>)。先安裝python <code>sudo apt install python</code>、<code>sudo apt install net-tools</code>。(或者可以直接登上[這裏](<a href="http://usereg.tsinghua.edu.cn/main.php">清华大学校园网自助服务系统 (tsinghua.edu.cn)</a>)查看)</p>
<img style="zoom:67%;" alt="image-20220327182031867" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220327182031867.png" title="">

<ol>
<li><p>以163mail為例，163 mail需要在設置裏，開啟smtp服務功能，然後記住所得到的授權密碼。</p>
<p><img alt="image-20220322104608774" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220322104608774.png"></p>
<p><img alt="image-20220322111707029" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220322111707029.png"></p>
<p><img alt="image-20220322111748552" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220322111748552.png"></p>
<p>mail.py</p>
<pre><code class="fenced-code-block language-python"><span class="token comment">#!/usr/bin/python </span>
<span class="token comment">#-*- coding:utf-8 -*-</span>
<span class="token keyword">import</span> smtplib 
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText 
<span class="token keyword">import</span> sys  
mail_host <span class="token operator">=</span> <span class="token string">'smtp.163.com'</span> <span class="token comment">#smtp地址</span>
mail_user <span class="token operator">=</span> <span class="token string">'username'</span> <span class="token comment">#你的郵箱帳號</span>
mail_pass <span class="token operator">=</span> <span class="token string">'smtp_code'</span> <span class="token comment">#smtp服務中提供的授權密碼</span>
mail_postfix <span class="token operator">=</span> <span class="token string">'163.com'</span>

<span class="token keyword">def</span> <span class="token function">send_mail</span><span class="token punctuation">(</span>to_list<span class="token punctuation">,</span>subject<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span> 
      me <span class="token operator">=</span> <span class="token string">'myPi'</span><span class="token operator">+</span><span class="token string">"&lt;"</span><span class="token operator">+</span>mail_user<span class="token operator">+</span><span class="token string">"@"</span><span class="token operator">+</span>mail_postfix<span class="token operator">+</span><span class="token string">"&gt;"</span>
      msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>content<span class="token punctuation">)</span> 
      msg<span class="token punctuation">[</span><span class="token string">'Subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> subject 
      msg<span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">]</span> <span class="token operator">=</span> me 
      msg<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span> <span class="token operator">=</span> to_list 

      <span class="token keyword">try</span><span class="token punctuation">:</span> 
          s <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token punctuation">)</span> 
          s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>mail_host<span class="token punctuation">)</span> 
          s<span class="token punctuation">.</span>login<span class="token punctuation">(</span>mail_user<span class="token punctuation">,</span>mail_pass<span class="token punctuation">)</span> 
          s<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>me<span class="token punctuation">,</span>to_list<span class="token punctuation">,</span>msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
          s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span> 
          <span class="token keyword">return</span> <span class="token boolean">True</span>
      <span class="token keyword">except</span> Exception<span class="token punctuation">,</span>e<span class="token punctuation">:</span> 
          <span class="token keyword">print</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> 
          <span class="token keyword">return</span> <span class="token boolean">False</span>

  <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span> 
          send_mail<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre>
<p>ip.sh</p>
<pre><code class="fenced-code-block language-shell"><span class="token shebang important">#!/bin/bash</span>
  <span class="token function">sleep</span> <span class="token number">20</span>
  <span class="token assign-left variable">wlan0</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ifconfig</span>  wlan0 <span class="token operator">|</span> <span class="token function">head</span> -n2 <span class="token operator">|</span> <span class="token function">grep</span> inet <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print$2}'</span><span class="token variable">`</span></span>
  <span class="token assign-left variable">eth0</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ifconfig</span>  eth0 <span class="token operator">|</span> <span class="token function">head</span> -n2 <span class="token operator">|</span> <span class="token function">grep</span> inet <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print$2}'</span><span class="token variable">`</span></span>

  <span class="token keyword">if</span> <span class="token function">ping</span> -c <span class="token number">2</span> -W <span class="token number">3</span> www.baidu.com <span class="token operator">&amp;&gt;</span> /dev/null <span class="token punctuation">;</span><span class="token keyword">then</span>
  /home/ubuntu/mail.py striketong@163.com <span class="token string">"Got raspberryPi IP!"</span> <span class="token string">"WLAN0:<span class="token variable">$wlan0</span>||ETH0:<span class="token variable">$eth0</span>"</span>
  <span class="token keyword">fi</span></code></pre>
</li>
<li><p>給予兩個腳本權限</p>
<pre><code class="fenced-code-block">sudo chmod +x ip.sh
sudo chmod +x mail.py</code></pre>
</li>
<li><p>將腳本加入開機執行文件。這邊由於沒有rc.local，需要自己創建，參考<a href="%5Bubuntu%E6%B2%A1%E6%9C%89/etc/rc.local%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%8C%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8_%E9%BB%84%E5%AE%9D%E9%BB%84%E5%AE%9D%E7%9A%84%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2_51CTO%E5%8D%9A%E5%AE%A2%5D(https://blog.51cto.com/u_4048786/3204026)">網址</a></p>
<ol>
<li><p>創建systemd的服务脚本，<code>sudo vim /etc/systemd/system/rc-local.service</code></p>
<pre><code class="fenced-code-block">[Unit]
 Description=/etc/rc.local Compatibility
 ConditionPathExists=/etc/rc.local

[Service]
 Type=forking
 ExecStart=/etc/rc.local start
 TimeoutSec=0
 StandardOutput=tty
 RemainAfterExit=yes
 SysVStartPriority=99

[Install]
 WantedBy=multi-user.target</code></pre>
</li>
<li><p>啟動服務</p>
<pre><code class="fenced-code-block">sudo systemctl enable rc-local.service</code></pre>
</li>
<li><p>編寫rc.local，<code>sudo vim /etc/rc.local</code></p>
<pre><code class="fenced-code-block">#!/bin/bash

sudo /home/ubuntu/ip.sh</code></pre>
</li>
<li><p>給予權限 <code>sudo chmod +x /etc/rc.local</code></p>
</li>
<li><p>嘗試重啟設備 <code>sudo reboot</code>，看能否收到郵件</p>
</li>
<li><p>成功收到帶有IP的郵件</p>
<p><img alt="image-20220322112758382" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220322112758382.png"></p>
</li>
<li><p>根據學長們的[使用手冊](<a href="https://thu.services/services/#tsinghua-secure">服务 - THU Services</a>)，通過<code>wpa_supplicant</code>進行Tsinghua-Secure的配置</p>
</li>
<li><p>通過顯示屏，直接在樹莓派的Terminal 中，通过命令“iw dev”查看无线网卡的标识：</p>
<p><img alt="image-20220322120137518" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220322120137518.png"></p>
</li>
<li><p>输入如下命令，创建用于连接 802.1x 无线网络的配置文件：</p>
<p>编辑 <code>vim /etc/wpa_supplicant/wpa_supplicant-nl80211-wlan0.conf</code>， 其中 <code>wlan0</code> 是本机网卡名称，输入以下配置</p>
<pre><code class="fenced-code-block">ctrl_interface=/var/run/wpa_supplicant
update_config=1

network={
        ssid="Tsinghua-Secure"
        proto=RSN
        key_mgmt=WPA-EAP
        pairwise=CCMP
        eap=PEAP
        identity="username"
        password="password"
        phase2="auth=MSCHAPV2"
        priority=9
}  </code></pre>
<p>其中 <code>username</code> 与 <code>password</code> 为自己帐号相应信息。</p>
</li>
<li><p>重新編輯<code>ip.sh</code></p>
<pre><code class="fenced-code-block language-shell"><span class="token shebang important">#!/bin/bash</span>
<span class="token function">sudo</span> <span class="token function">killall</span> wpa_supplicant
<span class="token function">sleep</span> <span class="token number">5</span>
<span class="token function">sudo</span> wpa_supplicant -B -c /etc/wpa_supplicant/wpa_supplicant-nl80211-wlan0.conf -i wlan0
<span class="token function">sudo</span> dhclient wlan0
<span class="token function">sleep</span> <span class="token number">30</span>
<span class="token assign-left variable">wlan0</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ifconfig</span>  wlan0 <span class="token operator">|</span> <span class="token function">head</span> -n2 <span class="token operator">|</span> <span class="token function">grep</span> inet <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print$2}'</span><span class="token variable">`</span></span>
<span class="token assign-left variable">eth0</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ifconfig</span>  eth0 <span class="token operator">|</span> <span class="token function">head</span> -n2 <span class="token operator">|</span> <span class="token function">grep</span> inet <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print$2}'</span><span class="token variable">`</span></span>

<span class="token keyword">if</span> <span class="token function">ping</span> -c <span class="token number">2</span> -W <span class="token number">3</span> www.baidu.com <span class="token operator">&amp;&gt;</span> /dev/null <span class="token punctuation">;</span><span class="token keyword">then</span>
/home/ubuntu/mail.py striketong@163.com <span class="token string">"Got raspberryPi IP!"</span> <span class="token string">"WLAN0:<span class="token variable">$wlan0</span>||ETH0:<span class="token variable">$eth0</span>"</span>
<span class="token keyword">fi</span></code></pre>
</li>
<li><p>重啟測試<code>sudo reboot</code>，看是否能自動連上Tsinghua-Secure</p>
</li>
<li><p>開機自動連接成功。</p>
</li>
</ol>
</li>
</ol>
<h4 class="atx" id="3-修改ssh-port">3. 修改SSH port</h4>
<p>由於校園網禁止22端口，所以需要修改預設端口。改成你想要的端口。需注意，0-1024，8000-8100，3389，9100這些都不能用。</p>
<ol>
<li><p><code>sudo vim /etc/ssh/ssh_config</code>、<code>sudo vim /etc/ssh/sshd_config</code>，找到<code>#Port 22</code>，改成<code>Port 8122</code>。</p>
</li>
<li><p>設置防火牆</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> ufw allow <span class="token number">8122</span></code></pre>
</li>
<li><p>重啟SSH服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">service</span> sshd restart</code></pre>
</li>
<li><p>嘗試利用SSH連接<code>ssh -p 8122 ubuntu@ip</code>，成功。</p>
</li>
</ol>
<h4 class="atx" id="4-配置picocom">4. 配置picocom</h4>
<p>利用picocom來獲取串口的調試訊息，甚至可在串口直接為FU740安裝系統。</p>
<ol>
<li><p>安裝picocom</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> picocom</code></pre>
</li>
</ol>
<h4 class="atx" id="5-配置usbip">5. 配置usbip</h4>
<p>FU740裏有內建的UART/JTAG to USB可以直接利用usb訪問串口。而對於遠程訪問，可以利用usbip遠程訪問USB，繼而訪問串口。</p>
<ol>
<li><p>安裝usbip</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> linux-tools-common
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> linux-tools-5.4.0-1058-raspi</code></pre>
</li>
<li><p>配置</p>
<pre><code class="fenced-code-block language-shell"><span class="token comment"># server</span>
<span class="token comment"># load usbip kernel module</span>
$ <span class="token function">sudo</span> modprobe usbip_host
<span class="token comment"># start control daemon</span>
$ <span class="token function">sudo</span> usbipd
<span class="token comment"># list available local devices</span>
$ usbip list -l
<span class="token comment"># export USB device</span>
$ <span class="token function">sudo</span> usbip <span class="token builtin class-name">bind</span> -b <span class="token operator">&lt;</span>busid<span class="token operator">&gt;</span>
<span class="token comment">#sudo usbip bind -b 1-1.1</span>
<span class="token comment">#sudo usbip bind -b 1-1.3</span></code></pre>
</li>
<li><p>若想在開機時自動啟動，編寫<code>sudo vim /etc/systemd/system/usbip.service</code>，$(uname -r)替換成相應的板本號。</p>
<p>如</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -r<span class="token variable">)</span></span>
<span class="token number">5.4</span>.0-1058-raspi</code></pre>
<p>usbip.service</p>
<pre><code class="fenced-code-block">[Unit]
Description=usbip host daemon
After=network.target

[Service]
Type=simple
ExecStart=/usr/lib/linux-tools/$(uname -r)/usbipd &amp;
ExecStartPost=/bin/sh -c "/usr/lib/linux-tools/$(uname -r)/usbip bind -b 1-1.1"
ExecStartPost=/bin/sh -c "/usr/lib/linux-tools/$(uname -r)i/usbip bind -b 1-1.3"
ExecStop=/bin/sh -c "/usr/lib/linux-tools/$(uname -r)/usbip unbind -b 1-1.1"
ExecStop=/bin/sh -c "/usr/lib/linux-tools/$(uname -r)/usbip unbind -b 1-1.3"

[Install]
WantedBy=multi-user.target</code></pre>
</li>
<li><p>啟用服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> systemctl --system daemon-reload
$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> usbip.service
$ <span class="token function">sudo</span> systemctl start usbip.service</code></pre>
</li>
<li><p>用戶端配置</p>
<pre><code class="fenced-code-block language-shell"><span class="token comment"># client</span>
<span class="token comment"># load vhci-hcd kernel module</span>
$ <span class="token function">sudo</span> modprobe vhci-hcd
<span class="token comment"># list available remote devices</span>
$ usbip list -r <span class="token operator">&lt;</span>server<span class="token operator">&gt;</span>
<span class="token comment"># attach remote device locally</span>
$ usbip attach -r <span class="token operator">&lt;</span>server<span class="token operator">&gt;</span> -b <span class="token operator">&lt;</span>busid<span class="token operator">&gt;</span></code></pre>
</li>
</ol>
<h4 class="atx" id="6-配置tftp服務器">6. 配置tftp服務器</h4>
<p>需要利用tftp來為FU740安裝系統。</p>
<ol>
<li><p>安裝tftpd，<code>sudo apt-get install xinetd tftpd-hpa</code></p>
</li>
<li><p>建立 TFTP 的配置文件，<code>sudo vim /etc/xinetd.d/tftp</code></p>
<pre><code class="fenced-code-block">service tftp
{
    socket_type     = dgram
    protocol         = udp
    wait                  = yes
    user                     = root
    server         = /usr/sbin/in.tftpd
    server_args     = -s /srv/tftp -c
    disable     = no
    per_source    = 11
    cps             = 100 2
    flags             = IPv4
}</code></pre>
</li>
<li><p>更改配置文件，<code>sudo vim /etc/default/tftpd-hpa</code>，添加<code>--create</code></p>
<pre><code class="fenced-code-block"># /etc/default/tftpd-hpa

TFTP_USERNAME="tftp"
TFTP_DIRECTORY="/srv/tftp"
TFTP_ADDRESS=":8122"
TFTP_OPTIONS="-c -s -l"</code></pre>
</li>
<li><p>更改工作文件夾權限</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">chown</span> tftp:tftp /srv/tftp</code></pre>
</li>
<li><p>啟動服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> /etc/init.d/xinetd restart
$ <span class="token function">sudo</span> /etc/init.d/tftpd-hpa restart</code></pre>
</li>
<li><p>查看服務是否正在運行</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">netstat</span> -a <span class="token operator">|</span><span class="token function">grep</span> tftp
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:tftp            <span class="token number">0.0</span>.0.0:*

$ <span class="token function">sudo</span> systemctl status tftpd-hpa

● tftpd-hpa.service - LSB: HPA<span class="token string">'s tftp server
     Loaded: loaded (/etc/init.d/tftpd-hpa; generated)
     Active: active (running) since Mon 2022-04-25 13:17:45 UTC; 2s ago
       Docs: man:systemd-sysv-generator(8)
    Process: 2344985 ExecStart=/etc/init.d/tftpd-hpa start (code=exited, statu&gt;
      Tasks: 1 (limit: 9257)
     CGroup: /system.slice/tftpd-hpa.service
             └─2345011 /usr/sbin/in.tftpd --listen --user tftp --address 0.0.0&gt;

Apr 25 13:17:45 rpiroot systemd[1]: Starting LSB: HPA'</span>s tftp server<span class="token punctuation">..</span>.
Apr <span class="token number">25</span> <span class="token number">13</span>:17:45 rpiroot tftpd-hpa<span class="token punctuation">[</span><span class="token number">2344985</span><span class="token punctuation">]</span>:  * Starting HPA<span class="token string">'s tftpd in.tftpd
Apr 25 13:17:45 rpiroot tftpd-hpa[2344985]:    ...done.
Apr 25 13:17:45 rpiroot systemd[1]: Started LSB: HPA'</span>s tftp server.</code></pre>
</li>
<li><p>客戶端請查看板本是否是tftp-hpa，如否請安裝tftp-hpa以配對服務器上的tftpd-hpa</p>
<pre><code class="fenced-code-block language-shell">$ dpkg -l tftp-hpa
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> tftp-hpa</code></pre>
</li>
</ol>
<h4 class="atx" id="7-配置dhcp">7. 配置dhcp</h4>
<ol>
<li><p>安裝dhcp</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> isc-dhcp-server</code></pre>
</li>
<li><p>啟用服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> systemctl start isc-dhcp-server
$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> isc-dhcp-server</code></pre>
</li>
<li><p>配置DHCP服務器文件，<code>sudo vim /etc/dhcp/dhcpd.conf</code>，添加如下內容</p>
<pre><code class="fenced-code-block">subnet 10.0.1.0 netmask 255.255.255.0 {
   authoritative;
   range 10.0.1.5 10.0.1.255;
   default-lease-time 3600;
   max-lease-time 3600;
   option subnet-mask 255.255.255.0;
   option broadcast-address 10.0.1.255;
   option routers 10.0.1.5;
   option domain-name-servers 166.111.8.28; # 清華的DNS
}</code></pre>
</li>
<li><p>設定DHCP啟用的網絡卡，<code>sudo vim /etc/default/isc-dhcp-server</code>，<code>sudo vim /etc/default/dhcpd.conf</code></p>
<pre><code class="fenced-code-block">INTERFACESv4="eth0"</code></pre>
</li>
<li><p>重啟DHCP服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> systemctl restart isc-dhcp-server</code></pre>
</li>
<li><p>查看DHCP服務是否運行</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> systemctl status isc-dhcp-server

lines <span class="token number">1</span>--1<span class="token punctuation">..</span>.skipping<span class="token punctuation">..</span>.
● isc-dhcp-server.service - ISC DHCP IPv4 server
     Loaded: loaded <span class="token punctuation">(</span>/lib/systemd/system/isc-dhcp-server.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset:<span class="token operator">&gt;</span>
     Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Thu <span class="token number">2022</span>-03-31 <span class="token number">12</span>:40:41 UTC<span class="token punctuation">;</span> 12s ago
       Docs: man:dhcpd<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
   Main PID: <span class="token number">91898</span> <span class="token punctuation">(</span>dhcpd<span class="token punctuation">)</span>
      Tasks: <span class="token number">4</span> <span class="token punctuation">(</span>limit: <span class="token number">9257</span><span class="token punctuation">)</span>
     CGroup: /system.slice/isc-dhcp-server.service
             └─91898 dhcpd -user dhcpd -group dhcpd -f -4 -pf /run/dhcp-server/dhcpd.pid <span class="token operator">&gt;</span>

Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu dhcpd<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: PID file: /run/dhcp-server/dhcpd.pid
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu sh<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Wrote <span class="token number">0</span> leases to leases file.
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu dhcpd<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Wrote <span class="token number">0</span> leases to leases file.
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu dhcpd<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Listening on LPF/eth0/e4:5f:01:56:d8:57/10.0.1.0/24
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu sh<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Listening on LPF/eth0/e4:5f:01:56:d8:57/10.0.1.0/24
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu sh<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Sending on   LPF/eth0/e4:5f:01:56:d8:57/10.0.1.0/24
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu sh<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Sending on   Socket/fallback/fallback-net
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu dhcpd<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Sending on   LPF/eth0/e4:5f:01:56:d8:57/10.0.1.0/24
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu dhcpd<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Sending on   Socket/fallback/fallback-net
Mar <span class="token number">31</span> <span class="token number">12</span>:40:41 ubuntu dhcpd<span class="token punctuation">[</span><span class="token number">91898</span><span class="token punctuation">]</span>: Server starting service.
~
~</code></pre>
</li>
<li><p>為樹莓派配置固定IP，修改DHCP服務器文件<code>sudo vim /etc/dhcp/dhcpd.conf</code>，添加host，此後在每次分配時樹莓派上的有線網絡便會得到固定的IP地址。</p>
<pre><code class="fenced-code-block">subnet 10.0.1.0 netmask 255.255.255.0 {
   authoritative;
   range 10.0.1.5 10.0.1.255;
   default-lease-time 3600;
   max-lease-time 3600;
   option subnet-mask 255.255.255.0;
   option broadcast-address 10.0.1.255;
   option routers 10.0.1.5;
}
host rpiroot {
    hardware ethernet e4:5f:01:56:d8:57;
    fixed-address 10.0.1.5;
}  
host ubuntu { #在首次登入後，可根據板子的網卡MAC地址來分配固定IP
    hardware ethernet XX:XX:XX:XX:XX:XX;
    fixed-address 10.0.1.10;
}</code></pre>
</li>
</ol>
<h4 class="atx" id="8-建立遠程響應網站">8. 建立遠程響應網站</h4>
<p>為了避免每次登入樹莓派才能啟動FU740，在此利用http請求實現一個更簡單的開機關機的方法。</p>
<ol>
<li><p>安裝Flask，<code>sudo apt-get install -y python3-flask</code></p>
</li>
<li><p>編輯<code>power.py</code>，利用Flask建立簡易網站用以接收開關機操作請求。</p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">import</span> RPi<span class="token punctuation">.</span>GPIO <span class="token keyword">as</span> GPIO
<span class="token keyword">import</span> gpiod
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">button</span><span class="token punctuation">(</span>secs<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> gpiod<span class="token punctuation">.</span>Chip<span class="token punctuation">(</span><span class="token string">"gpiochip0"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> chip<span class="token punctuation">:</span>
        line <span class="token operator">=</span> chip<span class="token punctuation">.</span>get_line<span class="token punctuation">(</span>line<span class="token punctuation">)</span>
        line<span class="token punctuation">.</span>request<span class="token punctuation">(</span>consumer<span class="token operator">=</span><span class="token string">"powerd"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span>gpiod<span class="token punctuation">.</span>LINE_REQ_DIR_OUT<span class="token punctuation">)</span>
        line<span class="token punctuation">.</span>set_value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>secs<span class="token punctuation">)</span>
        line<span class="token punctuation">.</span>set_value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">"&lt;p&gt;Hello, World!&lt;/p&gt;"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/poweron1"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">poweron1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"&lt;p&gt;Power on machine-1!&lt;/p&gt;"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/poweroff1"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">poweroff1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"&lt;p&gt;Power off machine-1!&lt;/p&gt;"</span><span class="token string">""</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/reboot1"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">reboot1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    button<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"Rebooted machine-1!"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/poweron2"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">poweron2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"&lt;p&gt;Power on machine-2!&lt;/p&gt;"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/poweroff2"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">poweroff2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"&lt;p&gt;Power off machine-2!&lt;/p&gt;"</span><span class="token string">""</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/reboot2"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">reboot2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    button<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"Rebooted machine-2!"</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    button<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
    button<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8182</span><span class="token punctuation">)</span></code></pre>
</li>
<li><p>運行程序<code>python3 power.py</code>，之後便可以通過<code>http://IP:8182/operation</code>進行開關機操作。</p>
</li>
<li><p>配置服務文件，使得在樹莓派開機時自動運行<code>power.py</code></p>
<ol>
<li>編寫服務文件<code>sudo vim /etc/systemd/system/power.service</code></li>
</ol>
<pre><code class="fenced-code-block">[Unit]
Description=power control daemon
After=network.target

[Service]
ExecStart=/usr/bin/python3 /home/ubuntu/test/power.py

[Install]
WantedBy=multi-user.target</code></pre>
<ol start="2">
<li>啟動服務</li>
</ol>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> power.service</code></pre>
</li>
</ol>
<h4 class="atx" id="9-配置nat">9. 配置NAT</h4>
<p>為了讓板子能連接外網，需要配置NAT。</p>
<ol>
<li><p>安裝<code>iptables-persistent</code></p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> iptables-persistent</code></pre>
</li>
<li><p>配置NAT</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> iptables -t nat -F POSTROUTING
$ <span class="token function">sudo</span> iptables -t nat -A POSTROUTING -o wlan0 -j MASQUERADE
$ <span class="token function">sudo</span> iptables -A FORWARD -i eth0 -o wlan0 -s <span class="token number">10.0</span>.1.0/24 -m conntrack --ctstate NEW -j ACCEPT
$ <span class="token function">sudo</span> iptables -A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</code></pre>
</li>
<li><p>保存iptables，確保每次開機後都能加載NAT規則</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">su</span>
$ iptables-save <span class="token operator">&gt;</span> /etc/iptables/rules.v4</code></pre>
</li>
<li><p>開啟路由轉發，編輯<code>sudo vim /etc/sysctl.conf</code> 文件</p>
<pre><code class="fenced-code-block">#net.ipv4.ip_forward=1 --&gt; net.ipv4.ip_forward=1</code></pre>
</li>
<li><p>啟用服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> sysctl -p</code></pre>
</li>
</ol>
<h4 class="atx" id="10-配置docker">10. 配置Docker</h4>
<p>根據[官網](<a href="https://docs.docker.com/engine/install/ubuntu/">Install Docker Engine on Ubuntu | Docker Documentation</a>)上的教程來進行安裝</p>
<h5 class="atx" id="設置倉庫">設置倉庫</h5>
<ol>
<li><p>卸載舊板本</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> remove <span class="token function">docker</span> docker-engine docker.io containerd runc</code></pre>
</li>
<li><p>設置倉庫</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token punctuation">\</span>
    ca-certificates <span class="token punctuation">\</span>
    <span class="token function">curl</span> <span class="token punctuation">\</span>
    gnupg <span class="token punctuation">\</span>
    lsb-release</code></pre>
</li>
<li><p>添加官方GPG Key</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">curl</span> -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</code></pre>
</li>
<li><p>設置穩定版倉庫</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token builtin class-name">echo</span> <span class="token punctuation">\</span>
  <span class="token string">"deb [arch=<span class="token variable"><span class="token variable">$(</span>dpkg --print-architecture<span class="token variable">)</span></span> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  <span class="token variable"><span class="token variable">$(</span>lsb_release -cs<span class="token variable">)</span></span> stable"</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/docker.list <span class="token operator">&gt;</span> /dev/null*</code></pre>
</li>
</ol>
<h5 class="atx" id="安裝docker-engine">安裝Docker Engine</h5>
<ol>
<li><p>利用apt進行安裝</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> docker-ce docker-ce-cli containerd.io</code></pre>
</li>
<li><p>測試Docker是否安裝成功，打印以下信息即為安裝成功</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">docker</span> run hello-world

Unable to <span class="token function">find</span> image <span class="token string">'hello-world:latest'</span> locally
latest: Pulling from library/hello-world
7050e35b49f5: Pull complete 
Digest: sha256:10d7d58d5ebd2a652f4d93fdd86da8f265f5318c6a73cc5b6a9798ff6d2b2e67
Status: Downloaded newer image <span class="token keyword">for</span> hello-world:latest

Hello from Docker<span class="token operator">!</span>
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 <span class="token number">1</span>. The Docker client contacted the Docker daemon.
 <span class="token number">2</span>. The Docker daemon pulled the <span class="token string">"hello-world"</span> image from the Docker Hub.
    <span class="token punctuation">(</span>arm64v8<span class="token punctuation">)</span>
 <span class="token number">3</span>. The Docker daemon created a new container from that image <span class="token function">which</span> runs the
    executable that produces the output you are currently reading.
 <span class="token number">4</span>. The Docker daemon streamed that output to the Docker client, <span class="token function">which</span> sent it
    to your terminal.

To try something <span class="token function">more</span> ambitious, you can run an Ubuntu container with:
 $ <span class="token function">docker</span> run -it ubuntu <span class="token function">bash</span>

Share images, automate workflows, and <span class="token function">more</span> with a <span class="token function">free</span> Docker ID:
 https://hub.docker.com/

For <span class="token function">more</span> examples and ideas, visit:
 https://docs.docker.com/get-started/</code></pre>
</li>
<li><p>安裝Docker-compose</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">docker-compose</span></code></pre>
</li>
<li><p>安裝Portainer 2.0 Web GUI，之後打開<a href="http://IP:9000%EF%BC%8C%E4%BE%BF%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0Docker%E7%AE%A1%E7%90%86">http://IP:9000，便可以看到Docker管理</a></p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">docker</span> pull portainer/portainer-ce:linux-arm64
$ <span class="token function">docker</span> run -d -p <span class="token number">9000</span>:9000 --restart unless-stopped --name portainer -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:linux-arm64 <span class="token punctuation">(</span>進入網址後，可以修改容器的名稱為<span class="token string">"protainer"</span>，方便之後直接啟動相同容器<span class="token punctuation">)</span>
$ <span class="token function">docker</span> start portainer</code></pre>
</li>
<li><p>給予Docker權限</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">groupadd</span> <span class="token function">docker</span>
$ <span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token environment constant">$USER</span></code></pre>
</li>
</ol>
<h5 class="atx" id="編寫dockerfile">編寫Dockerfile</h5>
<ol>
<li><p>編寫一個能夠連接串口的最低配置的Dockerfile</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token function">docker</span>
$ <span class="token builtin class-name">cd</span> <span class="token function">docker</span>
$ <span class="token function">vim</span> Dockerfile</code></pre>
<p>Dockerfile</p>
<pre><code class="fenced-code-block language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:20.04</span>

<span class="token instruction"><span class="token keyword">ARG</span> DEBIAN_FRONTEND=noninteractive</span>

<span class="token instruction"><span class="token keyword">RUN</span> apt-get update <span class="token operator">\</span>
    &amp;&amp; apt-get install -y iputils-ping <span class="token operator">\</span>
    &amp;&amp; apt-get install -y net-tools <span class="token operator">\</span>
    &amp;&amp; apt-get install -y picocom <span class="token operator">\</span>
    &amp;&amp; apt-get install -y vim <span class="token operator">\</span>
    &amp;&amp; apt-get install -y tftp-hpa <span class="token operator">\</span>
    <span class="token comment"># for SSH</span>
    &amp;&amp; apt-get install -y openssh-server <span class="token operator">\</span>
    &amp;&amp; apt-get install -y openssh-client <span class="token operator">\</span>
    &amp;&amp; apt-get install -y ssh</span>

<span class="token instruction"><span class="token keyword">CMD</span> bash</span></code></pre>
</li>
<li><p>生成鏡像。</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">docker</span> build -t ubuntu:custom <span class="token builtin class-name">.</span>
Step <span class="token number">1</span>/4 <span class="token builtin class-name">:</span> FROM ubuntu:20.04
 ---<span class="token operator">&gt;</span> e9af1a920203
Step <span class="token number">2</span>/4 <span class="token builtin class-name">:</span> ARG <span class="token assign-left variable">DEBIAN_FRONTEND</span><span class="token operator">=</span>noninteractive
 ---<span class="token operator">&gt;</span> Using cache
 ---<span class="token operator">&gt;</span> fca4a6a1e40d
Step <span class="token number">3</span>/4 <span class="token builtin class-name">:</span> RUN <span class="token function">apt-get</span> update     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">sudo</span>     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y iputils-ping     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y net-tools     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y picocom     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y kmod     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">vim</span>     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y openssh-server     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y openssh-client     <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">ssh</span>
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
Step <span class="token number">4</span>/4 <span class="token builtin class-name">:</span> CMD <span class="token function">bash</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 0a9505ef0a64
Removing intermediate container 0a9505ef0a64
 ---<span class="token operator">&gt;</span> ee714030dec7
Successfully built ee714030dec7
Successfully tagged ubuntu:custom</code></pre>
</li>
</ol>
<h5 class="atx" id="docker遠程訪問">Docker遠程訪問</h5>
<p><strong>目前如果利用Docker訪問的話，需要停掉系統的usbip服務，直接把USB掛載到Docker上。</strong></p>
<p>配置一個自定義網絡，方便管理Docker的IP</p>
<ol>
<li><p>創建自定義網絡，並且指定網段：172.18.0.0/16</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">docker</span> network create --subnet<span class="token operator">=</span><span class="token number">172.18</span>.0.0/16 testnet
$ <span class="token function">docker</span> network <span class="token function">ls</span>
NETWORK ID     NAME      DRIVER    SCOPE
ca1cf709e0e0   bridge    bridge    <span class="token builtin class-name">local</span>
3f1861d49981   <span class="token function">host</span>      <span class="token function">host</span>      <span class="token builtin class-name">local</span>
0760c0a8c058   none      null      <span class="token builtin class-name">local</span>
ba81bee543ca   testnet   bridge    <span class="token builtin class-name">local</span></code></pre>
</li>
<li><p>修改Dockerfile，並重新創建鏡像</p>
<pre><code class="fenced-code-block language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:20.04</span>

<span class="token instruction"><span class="token keyword">ARG</span> DEBIAN_FRONTEND=noninteractive</span>

<span class="token instruction"><span class="token keyword">RUN</span> apt-get update <span class="token operator">\</span>
    &amp;&amp; apt-get install -y iputils-ping <span class="token operator">\</span>
    &amp;&amp; apt-get install -y net-tools <span class="token operator">\</span>
    &amp;&amp; apt-get install -y picocom <span class="token operator">\</span>
    &amp;&amp; apt-get install -y vim <span class="token operator">\</span>
    &amp;&amp; apt-get install -y tftp-hpa <span class="token operator">\</span>
    <span class="token comment"># for SSH</span>
    &amp;&amp; apt-get install -y openssh-server <span class="token operator">\</span>
    &amp;&amp; apt-get install -y openssh-client <span class="token operator">\</span>
    &amp;&amp; apt-get install -y ssh</span>

<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"root:root"</span> | chpasswd</span>

<span class="token instruction"><span class="token keyword">COPY</span> startup_run.sh /root/startup_run.sh</span>

<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"# startup run"</span> &gt;&gt; /root/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"if [ -f /root/startup_run.sh ]; then"</span> &gt;&gt; /root/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"      /root/startup_run.sh"</span> &gt;&gt; /root/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"fi"</span> &gt;&gt; /root/.bashrc</span>

<span class="token instruction"><span class="token keyword">RUN</span> /bin/bash -c <span class="token string">'chmod +x /root/startup_run.sh'</span></span>

<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/#Port 22/Port 10008/g"</span> /etc/ssh/sshd_config</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/#PermitRootLogin prohibit-password/PermitRootLogin yes/g"</span> /etc/ssh/sshd_config</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/UsePAM yes/UsePAM no/g"</span> /etc/ssh/sshd_config</span>

<span class="token instruction"><span class="token keyword">EXPOSE</span> 10008</span>

<span class="token instruction"><span class="token keyword">CMD</span> bash</span></code></pre>
<p>其中startup_run.sh文件，需要<code>chmod +x /root/startup_run.sh</code></p>
<pre><code class="fenced-code-block language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">LOGTIME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">"+%Y-%m-%d %H:%M:%S"</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">"[<span class="token variable">$LOGTIME</span>] startup run..."</span> <span class="token operator">&gt;&gt;</span>/root/startup_run.log
<span class="token function">service</span> <span class="token function">ssh</span> start <span class="token operator">&gt;&gt;</span>/root/startup_run.log</code></pre>
</li>
<li><p>創建容器</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">docker</span> run -itd -w /workspace -v /home/test1:/workspace -p <span class="token number">10008</span>:10008 --net testnet --ip <span class="token number">172.18</span>.0.2 --name test1 --device<span class="token operator">=</span>/dev/ttyUSB1 ubuntu:custom <span class="token function">bash</span></code></pre>
<p>指令解釋</p>
<p>-itd：讓容器在後台執行，並有可交互的終端</p>
<p>-w：工作目錄</p>
<p>-v：把樹莓派上的目錄掛載到容器工作目錄上，可以方便用戶在容器上建立自己的目錄同時會儲存在樹莓派上</p>
<p>-p：指定port</p>
<p>--net：所使用的網絡</p>
<p>--ip：指定該容器所使用的IP，方便ssh訪問和管理</p>
<p>--name：指定容器名稱，方便之後的使用</p>
<p>--device：把串口掛載到容器上</p>
<p>ubuntu:custom：鏡像名稱</p>
</li>
<li><p>啟動容器</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">docker</span> start test1</code></pre>
</li>
<li><p>可以通過ssh遠程訪問容器</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">ssh</span> -J ubuntu@183.173.21.114 root@172.18.0.2 -p <span class="token number">10008</span>
root@172.18.0.2<span class="token string">'s password:
Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-1059-raspi aarch64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the '</span>unminimize' command.
Last login: Wed Apr <span class="token number">27</span> <span class="token number">14</span>:41:25 <span class="token number">2022</span> from <span class="token number">172.18</span>.0.1
root@84e3b56eec59:~<span class="token comment">#</span></code></pre>
</li>
</ol>
<h4 class="atx" id="11-更改時區">11. 更改時區</h4>
<ol>
<li><p>運行tzselect</p>
<pre><code class="fenced-code-block language-shell">$ tzselect</code></pre>
</li>
<li><p>依次選擇Asia, China, Bejing</p>
</li>
<li><p>複製文件</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">cp</span> /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime</code></pre>
</li>
<li><p>查看時間</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">date</span> -R</code></pre>
</li>
</ol>
<h4 class="atx" id="12-檢查docker是否仍有ssh連接">12. 檢查Docker是否仍有SSH連接</h4>
<p>為更好管理機器使用，可以定時檢查機器是否仍有人使用。</p>
<ol>
<li><p>安裝APSechduler庫，用於排程工作</p>
<pre><code class="fenced-code-block language-shell">$ pip3 <span class="token function">install</span> APScheduler</code></pre>
</li>
<li><p>配合MySQL，編寫檢查腳本status.py與check.py</p>
<p>status.py</p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">from</span> time <span class="token keyword">import</span> timezone
<span class="token keyword">from</span> apscheduler<span class="token punctuation">.</span>schedulers<span class="token punctuation">.</span>blocking <span class="token keyword">import</span> BlockingScheduler
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> time <span class="token keyword">import</span> localtime
<span class="token keyword">import</span> database
<span class="token keyword">import</span> docker_manage
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> check

<span class="token comment"># 服務器啟動時間</span>
server_start_time <span class="token operator">=</span> <span class="token number">9</span>

<span class="token comment"># 服務器定期更新</span>

<span class="token comment"># 每整點更新一次，用於Docker的更新</span>
server_update_time_week <span class="token operator">=</span> <span class="token string">'0-6'</span> <span class="token comment"># 0-6 代表 週一到週日工作</span>
server_update_time_hour <span class="token operator">=</span> <span class="token string">'10-21'</span> <span class="token comment"># 10-21 代表 10點開始第一次更新，21點最後一次更新</span>
server_update_time_min <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token comment"># 代表 XX:00:XX 更新</span>
server_update_time_sec <span class="token operator">=</span> <span class="token string">'1'</span> <span class="token comment"># 代表 XX:XX:01 更新</span>

<span class="token comment"># 每整點的55分檢查一次，用於提前5分鐘斷線的提示</span>
server_check_time_week <span class="token operator">=</span> <span class="token string">'0-6'</span>
server_check_time_hour <span class="token operator">=</span> <span class="token string">'10-21'</span>
server_check_time_min <span class="token operator">=</span> <span class="token string">'55'</span> <span class="token comment"># 代表 XX:55:XX 更新</span>
server_check_time_sec <span class="token operator">=</span> <span class="token string">'1'</span>

t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

log_name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_year<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_mon<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_mday<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.log'</span>

<span class="token comment"># 到時前五分鐘提示</span>
<span class="token keyword">def</span> <span class="token function">expired_remind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    now_docker_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    now_docker_names <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> now_docker_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> now_docker_names<span class="token punctuation">:</span>
        <span class="token keyword">for</span> now_docker_name <span class="token keyword">in</span> now_docker_names<span class="token punctuation">:</span>
            check<span class="token punctuation">.</span>expired_remind<span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span>

<span class="token comment"># 更新Docker</span>
<span class="token keyword">def</span> <span class="token function">update_machine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    period <span class="token operator">=</span> t<span class="token punctuation">.</span>tm_hour <span class="token operator">-</span> <span class="token number">9</span>

    <span class="token comment"># 第一個時間段不用特殊判斷</span>
    <span class="token keyword">if</span> period <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        docker_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        machine_no <span class="token operator">=</span> <span class="token number">1</span>
        docker_names <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> docker_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

        <span class="token comment"># 如果預約時間表不為空，即有人預約</span>
        <span class="token keyword">if</span> docker_names<span class="token punctuation">:</span>
            <span class="token keyword">for</span> docker_name <span class="token keyword">in</span> docker_names<span class="token punctuation">:</span>
                <span class="token keyword">if</span> docker_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>start_docker<span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span>

                    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                    <span class="token comment"># 記錄Docker啟動時間</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Start docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                    <span class="token comment"># 更新當前機器使用狀態</span>
                    database<span class="token punctuation">.</span>update_status<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> docker_name<span class="token punctuation">)</span>
                    machine_no <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token comment"># 之後的時間段，需要判斷 下個時間段有否預約，是否為同一人預約，是否使用同一機器</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 獲取下個時間段使用信息</span>
        next_docker_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        machine_no <span class="token operator">=</span> <span class="token number">1</span>

        <span class="token comment"># 判斷下個時間段是否有人使用，即時間表中是否為 'NULL'</span>
        next_docker_names <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> next_docker_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

        <span class="token comment"># 下個時間段有人預約</span>
        <span class="token keyword">if</span> next_docker_names<span class="token punctuation">:</span>
            now_docker_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            now_docker_names <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> now_docker_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

            <span class="token comment"># 如果目前有機器有分配用戶</span>
            <span class="token comment"># 則檢查下個時間段該用戶是否使用同一機器</span>
            <span class="token comment"># 若為同一機器則不中斷SSH連線，若不為同一機器則中斷SSH連線(停止 Docker)</span>
            <span class="token keyword">if</span> now_docker_names<span class="token punctuation">:</span>
                <span class="token keyword">for</span> now_docker_name <span class="token keyword">in</span> now_docker_names<span class="token punctuation">:</span>
                    <span class="token comment"># 不為同一機器</span>
                    <span class="token keyword">if</span> now_docker_name <span class="token keyword">not</span> <span class="token keyword">in</span> next_docker_names<span class="token punctuation">:</span>
                        user_name <span class="token operator">=</span> now_docker_name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>

                        path <span class="token operator">=</span> <span class="token string">'log/'</span> <span class="token operator">+</span> user_name
                        Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                        t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                        <span class="token comment"># 停止Docker</span>
                        output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>stop_docker<span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span>

                        <span class="token comment"># 記錄Docker停止時間</span>
                        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Stop  docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                        <span class="token comment"># 保存用戶操作記錄</span>
                        check<span class="token punctuation">.</span>save_user_log<span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span>

            <span class="token comment"># 根據預約時間表啟動下個時間段的Docker</span>
            <span class="token keyword">for</span> next_docker_name <span class="token keyword">in</span> next_docker_names<span class="token punctuation">:</span>
                <span class="token keyword">if</span> next_docker_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>start_docker<span class="token punctuation">(</span>next_docker_name<span class="token punctuation">)</span>

                    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Start docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                    <span class="token comment"># 更新當前機器使用狀態</span>
                    database<span class="token punctuation">.</span>update_status<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> next_docker_name<span class="token punctuation">)</span>
                    machine_no <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token comment"># 下個時間段沒有預約</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            now_docker_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            now_docker_names <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> now_docker_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

            <span class="token comment"># 檢查當前分配的用戶是否正在使用 &lt;-- 檢查SSH連線情況，如果SSH用戶為0，則Docker沒人使用</span>
            <span class="token keyword">if</span> now_docker_names<span class="token punctuation">:</span>
                <span class="token keyword">for</span> now_docker_name <span class="token keyword">in</span> now_docker_names<span class="token punctuation">:</span>
                    ssh_usr <span class="token operator">=</span> check<span class="token punctuation">.</span>check_alive<span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span>

                    <span class="token keyword">if</span> ssh_usr <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>
                        user_name <span class="token operator">=</span> now_docker_name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>

                        path <span class="token operator">=</span> <span class="token string">'log/'</span> <span class="token operator">+</span> user_name
                        Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                        t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                        <span class="token comment"># 停止Docker</span>
                        output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>stop_docker<span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span>

                        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Stop  docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                        <span class="token comment"># 保存用戶操作記錄</span>
                        check<span class="token punctuation">.</span>save_user_log<span class="token punctuation">(</span>now_docker_name<span class="token punctuation">)</span>

                        <span class="token comment"># 更新當前機器使用狀態</span>
                        database<span class="token punctuation">.</span>update_status<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> <span class="token string">'NULL'</span><span class="token punctuation">)</span>

                    machine_no <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    <span class="token comment"># 設定時間</span>
    scheduler <span class="token operator">=</span> BlockingScheduler<span class="token punctuation">(</span>timezone<span class="token operator">=</span><span class="token string">"Asia/Shanghai"</span><span class="token punctuation">)</span>

    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 當時間在服務器工作時間時啟動服務</span>
        <span class="token keyword">if</span> t<span class="token punctuation">.</span>tm_hour <span class="token operator">&gt;=</span> server_start_time<span class="token punctuation">:</span>

            <span class="token comment"># 添加更新時間表排程服務</span>
            scheduler<span class="token punctuation">.</span>add_job<span class="token punctuation">(</span>update_machine<span class="token punctuation">,</span> <span class="token string">'cron'</span><span class="token punctuation">,</span> 
                                            day_of_week<span class="token operator">=</span>server_update_time_week<span class="token punctuation">,</span> 
                                            hour<span class="token operator">=</span>server_update_time_hour<span class="token punctuation">,</span> 
                                            minute<span class="token operator">=</span>server_update_time_min<span class="token punctuation">,</span>
                                            second<span class="token operator">=</span>server_update_time_sec
                                            <span class="token punctuation">)</span>

            <span class="token comment"># 添加提示結束排程服務    </span>
            scheduler<span class="token punctuation">.</span>add_job<span class="token punctuation">(</span>expired_remind<span class="token punctuation">,</span> <span class="token string">'cron'</span><span class="token punctuation">,</span> 
                                            day_of_week<span class="token operator">=</span>server_check_time_week<span class="token punctuation">,</span> 
                                            hour<span class="token operator">=</span>server_check_time_hour<span class="token punctuation">,</span> 
                                            minute<span class="token operator">=</span>server_check_time_min<span class="token punctuation">,</span>
                                            second<span class="token operator">=</span>server_check_time_sec
                                            <span class="token punctuation">)</span>

            <span class="token comment"># 開啟排程服務</span>
            scheduler<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>check.py</p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">import</span> docker

<span class="token comment"># 返回Docker SSH連線數</span>
<span class="token keyword">def</span> <span class="token function">check_alive</span><span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span><span class="token punctuation">:</span>

    client <span class="token operator">=</span> docker<span class="token punctuation">.</span>from_env<span class="token punctuation">(</span><span class="token punctuation">)</span>

    container <span class="token operator">=</span> client<span class="token punctuation">.</span>containers<span class="token punctuation">.</span>get<span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span>
    output <span class="token operator">=</span> container<span class="token punctuation">.</span>exec_run<span class="token punctuation">(</span>cmd<span class="token operator">=</span><span class="token string">'w | grep pts'</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>output<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>

    num <span class="token operator">=</span> output<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> num<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment"># 預約到時提醒</span>
<span class="token keyword">def</span> <span class="token function">expired_remind</span><span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span><span class="token punctuation">:</span>

    client <span class="token operator">=</span> docker<span class="token punctuation">.</span>from_env<span class="token punctuation">(</span><span class="token punctuation">)</span>

    container <span class="token operator">=</span> client<span class="token punctuation">.</span>containers<span class="token punctuation">.</span>get<span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span>
    output <span class="token operator">=</span> container<span class="token punctuation">.</span>exec_run<span class="token punctuation">(</span>cmd<span class="token operator">=</span><span class="token string">"wall /etc/remind"</span><span class="token punctuation">)</span>

<span class="token comment"># 保存用戶操作記錄到主機</span>
<span class="token keyword">def</span> <span class="token function">save_user_log</span><span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span><span class="token punctuation">:</span>

    client <span class="token operator">=</span> docker<span class="token punctuation">.</span>from_env<span class="token punctuation">(</span><span class="token punctuation">)</span>
    usr_name <span class="token operator">=</span> docker_name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    docker_command <span class="token operator">=</span> <span class="token string">'docker cp '</span> <span class="token operator">+</span> docker_name <span class="token operator">+</span> <span class="token string">':/etc/session.log /docker_usr/info/'</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">'/log/'</span>
    subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span>docker_command<span class="token punctuation">]</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre>
</li>
</ol>
<h4 class="atx" id="13-利用python腳本自動生成docker">13. 利用Python腳本自動生成Docker</h4>
<ol>
<li><p>編寫docker_manage.py</p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span>  
<span class="token keyword">import</span> time
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> database
<span class="token keyword">import</span> time
<span class="token keyword">import</span> docker

<span class="token comment"># 機器數目</span>
machine_num <span class="token operator">=</span> <span class="token number">3</span>

<span class="token comment"># 啟動Docker</span>
<span class="token keyword">def</span> <span class="token function">start_docker</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    output <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"docker start "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
    output <span class="token operator">=</span> output<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'b\''</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> output<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\n\''</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> output

<span class="token comment"># 停止Docker</span>
<span class="token keyword">def</span> <span class="token function">stop_docker</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    output <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"docker stop "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
    output <span class="token operator">=</span> output<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'b\''</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    output <span class="token operator">=</span> output<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\n\''</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> output

<span class="token comment"># 新建Docker</span>
<span class="token keyword">def</span> <span class="token function">make_docker</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_num <span class="token operator">=</span> database<span class="token punctuation">.</span>check_size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
    outputs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> <span class="token builtin">id</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>machine_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Port從20000開始，每個用戶新增三個Docker，分配三個Port</span>
        port <span class="token operator">=</span> <span class="token number">20000</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> user_num <span class="token operator">+</span> <span class="token builtin">id</span>
        docker_command <span class="token operator">=</span><span class="token string">"docker run -itd"</span> <span class="token operator">+</span> \
                        <span class="token string">" -w /root/"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> \
                        <span class="token string">" -v /docker_usr/user/"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">":/root/"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> \
                        <span class="token string">" -v /docker_usr/info/"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">"/ssh_keys/"</span> <span class="token operator">+</span> <span class="token string">":/root/.ssh"</span> <span class="token operator">+</span> \
                        <span class="token string">" -p "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span> <span class="token operator">+</span> \
                        <span class="token string">":10008"</span> <span class="token operator">+</span> \
                        <span class="token string">" --net testnet"</span> <span class="token operator">+</span> \
                        <span class="token string">" --name "</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">id</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> \
                        <span class="token string">" --device=/dev/ttyUSB"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">id</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> \
                        <span class="token string">" ubuntu:u740 bash"</span>
        subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span>docker_command<span class="token punctuation">]</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        docker_command <span class="token operator">=</span><span class="token string">"docker stop "</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">id</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        output <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span>docker_command<span class="token punctuation">]</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        output <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
        output <span class="token operator">=</span> output<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'b\''</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        output <span class="token operator">=</span> output<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\n\''</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        outputs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>output<span class="token punctuation">)</span>

    <span class="token keyword">return</span> outputs</code></pre>
</li>
</ol>
<h4 class="atx" id="14-記錄用戶操作記錄">14. 記錄用戶操作記錄</h4>
<p>記錄用戶在Docker內的操作以及輸出記錄，利用系統內置的<code>Script</code>來實現此功能。</p>
<ol>
<li><p>新增<code>.profile</code>文件，用以替換Docker內的文件。</p>
<p><code>addate()</code>函數為script記錄增加時間戳。</p>
<p><code>-fq</code> 參數使Script能夠刷新緩衝區以及以靜默狀態執行。</p>
<p><code>&amp;&amp; exit</code> 因為在執行script的情況下使用exit退出SSH的話會先退出script，因此多添加一個exit，使用戶在輸入exit能夠直接退出SSH不是只退出script。</p>
<pre><code class="fenced-code-block language-shell"><span class="token comment"># ~/.profile: executed by Bourne-compatible login shells.</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token environment constant">$BASH</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> -f ~/.bashrc <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">.</span> ~/.bashrc
  <span class="token keyword">fi</span>
<span class="token keyword">fi</span>

mesg n <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> /dev/null <span class="token operator">||</span> <span class="token boolean">true</span>

<span class="token function-name function">adddate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line<span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">printf</span> <span class="token string">'%s %s\n'</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span><span class="token variable">)</span></span>"</span> <span class="token string">"<span class="token variable">$line</span>"</span><span class="token punctuation">;</span>
    <span class="token keyword">done</span>
<span class="token punctuation">}</span>

/usr/bin/script -fq <span class="token operator">&gt;</span><span class="token punctuation">(</span> adddate <span class="token operator">&gt;&gt;</span> /etc/session.log<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span></code></pre>
</li>
</ol>
<h4 class="atx" id="15-更新dockerfile以及增加相關文件">15. 更新Dockerfile以及增加相關文件</h4>
<p>通過不斷的更新後，需要更改Dockerfile來配合。</p>
<ol>
<li><p>修改Dockerfile</p>
<pre><code class="fenced-code-block language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:20.04</span>

<span class="token instruction"><span class="token keyword">ARG</span> DEBIAN_FRONTEND=noninteractive</span>

<span class="token instruction"><span class="token keyword">RUN</span> apt-get update <span class="token operator">\</span>
    &amp;&amp; apt-get install -y iputils-ping <span class="token operator">\</span>
    &amp;&amp; apt-get install -y net-tools <span class="token operator">\</span>
    &amp;&amp; apt-get install -y picocom <span class="token operator">\</span>
    &amp;&amp; apt-get install -y vim <span class="token operator">\</span>
    &amp;&amp; apt-get install -y tftp-hpa <span class="token operator">\</span>
    <span class="token comment"># for SSH</span>
    &amp;&amp; apt-get install -y openssh-server <span class="token operator">\</span>
    &amp;&amp; apt-get install -y openssh-client <span class="token operator">\</span>
    &amp;&amp; apt-get install -y ssh</span>

<span class="token comment"># 開機啟動SSH</span>

<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p ~/.ssh</span>

<span class="token instruction"><span class="token keyword">COPY</span> startup_run.sh /etc/startup_run.sh</span>
<span class="token instruction"><span class="token keyword">RUN</span> /bin/bash -c <span class="token string">'chmod +x /etc/startup_run.sh'</span></span>

<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"# startup run"</span> &gt;&gt; /root/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"if [ -f /etc/startup_run.sh ]; then"</span> &gt;&gt; /root/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"      /etc/startup_run.sh"</span> &gt;&gt; /root/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"fi"</span> &gt;&gt; /root/.bashrc</span>

<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/#Port 22/Port 10008/g"</span> /etc/ssh/sshd_config</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/#PermitRootLogin prohibit-password/PermitRootLogin yes/g"</span> /etc/ssh/sshd_config</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/#PasswordAuthentication yes/PasswordAuthentication no/g"</span> /etc/ssh/sshd_config</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">"s/UsePAM yes/UsePAM no/g"</span> /etc/ssh/sshd_config</span>

<span class="token instruction"><span class="token keyword">RUN</span> /bin/bash -c <span class="token string">'chmod -R go= /root/.ssh'</span></span>
<span class="token instruction"><span class="token keyword">RUN</span> /bin/bash -c <span class="token string">'chown -R root /root/.ssh'</span></span>

<span class="token comment"># 結束提示語句</span>
<span class="token instruction"><span class="token keyword">COPY</span> remind /etc/remind</span>
<span class="token instruction"><span class="token keyword">RUN</span> /bin/bash -c <span class="token string">'chmod +x /etc/remind'</span></span>

<span class="token comment"># 記錄甪戶操作記錄配置</span>
<span class="token instruction"><span class="token keyword">COPY</span> .profile /root/.profile</span>
<span class="token instruction"><span class="token keyword">RUN</span> /bin/bash -c <span class="token string">'chmod +x /root/.profile'</span></span>

<span class="token comment">#Expose Port</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 10008</span>

<span class="token instruction"><span class="token keyword">CMD</span> bashh'</span>

<span class="token comment">#Expose Port</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 10008</span>

<span class="token instruction"><span class="token keyword">CMD</span> bash</span></code></pre>
</li>
<li><p>remind文件</p>
<p>到時提示語句</p>
<pre><code class="fenced-code-block">:: SSH will shutdown in 5 minutes if you do not apply the same machine in next period, remember to save your files in time ::</code></pre>
</li>
<li><p>config文件</p>
<p>防止SSH閒置過久後自動斷線</p>
<pre><code class="fenced-code-block">Host *
 ServerAliveInterval 60
 ServerAliveCountMax 3</code></pre>
</li>
</ol>
<h4 class="atx" id="16-內嵌頁面自啟與moodle網址動態更新">16. 內嵌頁面自啟與Moodle網址動態更新</h4>
<p>由於校園網每天IP都有可能不一樣，因此需要動態修改Moodle的訪問地址。修改ip.sh，在裏面加入啟動項。</p>
<pre><code class="fenced-code-block">sudo sed -i "21c \$CFG-&gt;wwwroot   = 'http://$wlan0:8888/moodle';" /var/www/html/moodle/config.php

/usr/bin/python3 /home/ubuntu/applysystem/moodle.py &amp;</code></pre>
<h3 class="atx" id="fu740">FU740</h3>
<h4 class="atx" id="1-連接樹莓派與fu740">1. 連接樹莓派與FU740</h4>
<ol>
<li><p>利用杜邦線物理連接樹莓派與FU740</p>
<ol>
<li><p>把原本版子上的<code>POWER SW</code>線換成自己的杜邦線。</p>
<img style="zoom: 25%;" alt="image-20220328150633057" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220328150633057.png" title="">

<img style="zoom: 25%;" alt="image-20220328150655239" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220328150655239.png" title="">
</li>
<li><p>把繼電器全部切換成高電平觸發</p>
<img style="zoom:25%;" alt="image-20220328151918376" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220328151918376.png" title="">
</li>
<li><p>將杜邦線連接到繼電器上。（切記不要弄反，紫色接到NO1，白色接到COM1）</p>
</li>
<li><p>將樹莓派上的5V，GND以及訊號線(GPIO)接到繼電哭上的DC+，DC-，IN1上。接好後應如下圖所示。</p>
<p>可以利用<code>pinout</code>來查看樹莓派上的對應接口。這裏接GPIO14。</p>
<p><img alt="image-20220328152209310" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220328152209310.png"></p>
<p><img style="zoom:20%;" alt="image-20220328151624825" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220328151624825.png" title=""><img style="zoom: 20%;" alt="image-20220403145027796" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220403145027796.png" title=""></p>
</li>
<li><p>接上FU740電源，進行下一步調試。</p>
</li>
</ol>
</li>
<li><p>在樹莓派上安裝python GPIO庫，<code>sudo apt-get install python3-dev python3-rpi.gpio</code>，撰寫GPIO測試程序<code>power.py</code>。</p>
<p>給予python權限，<code>sudo chmod 4775 /usr/bin/python</code>，<code>sudo chmod 4775 /usr/bin/python3</code></p>
<ul>
<li>1秒是開機，4秒是強制關機。</li>
</ul>
<pre><code class="fenced-code-block">import gpiod
import time

def button(secs, line):
    with gpiod.Chip("gpiochip0") as chip:
        line = chip.get_line(line)
        line.request(consumer="powerd", type=gpiod.LINE_REQ_DIR_OUT)
        line.set_value(1)
        time.sleep(secs)
        line.set_value(0)

if __name__ == '__main__':
    button(1, 14)</code></pre>
<p>運行語句<code>python3 power.py</code>，運行後應該可以聽到十分清脆的繼電器啟動聲音以及十分響亮的風扇聲。這便說明成功利用樹莓派控制板子啟動了。</p>
</li>
</ol>
<h4 class="atx" id="2-安裝u-boot">2. 安裝U-Boot</h4>
<ol>
<li><p>在SD卡上寫入[U-boot](<a href="https://github.com/zhaofengli/nixos-riscv64/releases/tag/2022011700">Release HiFive Unmatched SD Image &amp; U-Boot SPI Installer · zhaofengli/nixos-riscv64 (github.com)</a>)</p>
</li>
<li><p>利用[Etcher](<a href="https://www.balena.io/etcher/">balenaEtcher - Flash OS images to SD cards &amp; USB drives</a>)把鏡像燒錄到SD卡上</p>
<img style="zoom:50%;" alt="image-20220330144132821" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220330144132821.png" title="">
</li>
<li><p>連接樹莓派與FU740終端，然後查看是否已經接上</p>
<pre><code class="fenced-code-block language-shell">$ lsusb</code></pre>
<p>如正確接入，應出下類似下面的訊息</p>
<pre><code class="fenced-code-block language-shell">Bus 003 Device 001: ID 1d6b:0002 Linux Foundation <span class="token number">2.0</span> root hub
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation <span class="token number">3.0</span> root hub
Bus 001 Device 004: ID 0403:6010 Future Technology Devices International, Ltd FT2232C/D/H Dual UART/FIFO IC
Bus 001 Device 005: ID 0403:6010 Future Technology Devices International, Ltd FT2232C/D/H Dual UART/FIFO IC
Bus 001 Device 002: ID <span class="token number">2109</span>:3431 VIA Labs, Inc. Hub
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation <span class="token number">2.0</span> root hub</code></pre>
<p>其中的 Device 004 和 Device 005 便是接上的數據線。</p>
</li>
<li><p>查看設備會話接口號</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">ls</span> /dev/ttyUSB*
/dev/ttyUSB0  /dev/ttyUSB1</code></pre>
<p>可以看到兩條數據線的名稱分別為 ttyUSB0 和 ttyUBS1。</p>
</li>
<li><p>利用picocom連接到串口，然後進行串口調試</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> picocom -b <span class="token number">115200</span> /dev/ttyUSB0

picocom v3.1

port is        <span class="token builtin class-name">:</span> /dev/ttyUSB0
flowcontrol    <span class="token builtin class-name">:</span> none
baudrate is    <span class="token builtin class-name">:</span> <span class="token number">115200</span>
parity is      <span class="token builtin class-name">:</span> none
databits are   <span class="token builtin class-name">:</span> <span class="token number">8</span>
stopbits are   <span class="token builtin class-name">:</span> <span class="token number">1</span>
escape is      <span class="token builtin class-name">:</span> C-a
<span class="token builtin class-name">local</span> <span class="token builtin class-name">echo</span> is  <span class="token builtin class-name">:</span> no
noinit is      <span class="token builtin class-name">:</span> no
noreset is     <span class="token builtin class-name">:</span> no
hangup is      <span class="token builtin class-name">:</span> no
nolock is      <span class="token builtin class-name">:</span> no
send_cmd is    <span class="token builtin class-name">:</span> sz -vv
receive_cmd is <span class="token builtin class-name">:</span> rz -vv -E
imap is        <span class="token builtin class-name">:</span> 
omap is        <span class="token builtin class-name">:</span> 
emap is        <span class="token builtin class-name">:</span> crcrlf,delbs,
logfile is     <span class="token builtin class-name">:</span> none
initstring     <span class="token builtin class-name">:</span> none
exit_after is  <span class="token builtin class-name">:</span> not <span class="token builtin class-name">set</span>
<span class="token builtin class-name">exit</span> is        <span class="token builtin class-name">:</span> no

Type <span class="token punctuation">[</span>C-a<span class="token punctuation">]</span> <span class="token punctuation">[</span>C-h<span class="token punctuation">]</span> to see available commands
Terminal ready</code></pre>
<p>若正常，會出現Terminal ready提示語句。</p>
</li>
<li><p>把SD卡插回FU740上，訪問網站指令開機。</p>
</li>
<li><p>應該會在命令行上看到如下輸出</p>
<pre><code class="fenced-code-block language-shell"><span class="token punctuation">..</span>.
Device <span class="token number">0</span>: Vendor: 0x144d Rev: 2B2QEXM7 Prod: S4EUNX0R802232Z     
            Type: Hard Disk
            Capacity: <span class="token number">238475.1</span> MB <span class="token operator">=</span> <span class="token number">232.8</span> GB <span class="token punctuation">(</span><span class="token number">488397168</span> x <span class="token number">512</span><span class="token punctuation">)</span>
<span class="token punctuation">..</span>. is now current device
** No partition table - nvme <span class="token number">0</span> **
Couldn't <span class="token function">find</span> partition nvme <span class="token number">0</span>:1
starting USB<span class="token punctuation">..</span>.
Bus xhci_pci: Register <span class="token number">4000840</span> NbrPorts <span class="token number">4</span>
Starting the controller
USB XHCI <span class="token number">1.00</span>
scanning bus xhci_pci <span class="token keyword">for</span> devices<span class="token punctuation">..</span>. <span class="token number">3</span> USB Device<span class="token punctuation">(</span>s<span class="token punctuation">)</span> found
       scanning usb <span class="token keyword">for</span> storage devices<span class="token punctuation">..</span>. <span class="token number">0</span> Storage Device<span class="token punctuation">(</span>s<span class="token punctuation">)</span> found

Device <span class="token number">0</span>: unknown device
switch to partitions <span class="token comment">#0, OK</span>
mmc0 is current device
Scanning mmc <span class="token number">0</span>:3<span class="token punctuation">..</span>.
Found U-Boot script /boot.scr
<span class="token number">2236</span> bytes <span class="token builtin class-name">read</span> <span class="token keyword">in</span> <span class="token number">4</span> ms <span class="token punctuation">(</span><span class="token number">545.9</span> KiB/s<span class="token punctuation">)</span>
<span class="token comment">## Executing script at 88100000</span>

Firmware installer

Installing U-Boot to the SPI flash <span class="token keyword">in</span> <span class="token number">10</span> seconds<span class="token operator">!</span>
devtype <span class="token operator">=</span> mmc
devnum <span class="token operator">=</span> <span class="token number">0</span>
bootpart <span class="token operator">=</span> <span class="token number">3</span>

:: Starting flash operation

-<span class="token operator">&gt;</span> Initializing SPI Flash subsystem<span class="token punctuation">..</span>.
SF: Detected is25wp256 with page size <span class="token number">256</span> Bytes, erase size <span class="token number">4</span> KiB, total <span class="token number">32</span> MiB

-<span class="token operator">&gt;</span> Reading new firmware from storage<span class="token punctuation">..</span>.
<span class="token number">6291456</span> bytes <span class="token builtin class-name">read</span> <span class="token keyword">in</span> <span class="token number">5423</span> ms <span class="token punctuation">(</span><span class="token number">1.1</span> MiB/s<span class="token punctuation">)</span>

-<span class="token operator">&gt;</span> Writing new firmware to SPI<span class="token punctuation">..</span>.
device <span class="token number">0</span> offset 0x0, size 0x600000
<span class="token number">2691072</span> bytes written, <span class="token number">3600384</span> bytes skipped <span class="token keyword">in</span> <span class="token number">47</span>.308s, speed <span class="token number">136770</span> B/s

✅ Flashing seems to have been successful<span class="token operator">!</span>
You can now <span class="token builtin class-name">set</span> MSEL<span class="token punctuation">[</span><span class="token number">3</span>:0<span class="token punctuation">]</span> <span class="token operator">=</span> 0110

Resetting <span class="token keyword">in</span> <span class="token number">5</span> seconds
resetting <span class="token punctuation">..</span>.    
System reset not supported on this platform
<span class="token comment">### ERROR ### Please RESET the board ###</span></code></pre>
</li>
<li><p>安裝完後把板子上的 MSEL碼 撥成(MSEL[3:0]=0110)，在下一次啟動時便不需要用到SD卡了</p>
<pre><code class="fenced-code-block"> --------------- ON
 |  | | o o |  |
 |  o o | | o  |
 --------------- OFF</code></pre>
</li>
<li><p>重新啟動機器，應該會出現如下輸出</p>
<pre><code class="fenced-code-block">U-Boot SPL 2022.01 (Jan 01 1980 - 00:00:00 +0000)
Trying to boot from SPI

U-Boot 2022.01 (Jan 01 1980 - 00:00:00 +0000)

CPU:   rv64imafdc
Model: SiFive HiFive Unmatched A00
DRAM:  16 GiB
MMC:   spi@10050000:mmc@0: 0
Loading Environment from SPIFlash... SF: Detected is25wp256 with page size 256 Bytes, erase size 4 KiB, total 32 MiB
*** Warning - bad CRC, using default environment

EEPROM: SiFive PCB EEPROM format v1
Product ID: 0002 (HiFive Unmatched)
PCB revision: 3
BOM revision: B
BOM variant: 0
Serial number: SF105SZ212200785
Ethernet MAC address: 70:b3:d5:92:f9:e1
CRC: a2ae439d
In:    serial@10010000
Out:   serial@10010000
Err:   serial@10010000
Model: SiFive HiFive Unmatched A00
Net:   eth0: ethernet@10090000
Hit any key to stop autoboot:  0 
PCIE-0: Link up (Gen1-x8, Bus0)

Device 0: Vendor: 0x144d Rev: 2B2QEXM7 Prod: S4EUNX0R802232Z     
            Type: Hard Disk
            Capacity: 238475.1 MB = 232.8 GB (488397168 x 512)
... is now current device
** No partition table - nvme 0 **
Couldn't find partition nvme 0:1
starting USB...
Bus xhci_pci: Register 4000840 NbrPorts 4
Starting the controller
USB XHCI 1.00
scanning bus xhci_pci for devices... 3 USB Device(s) found
       scanning usb for storage devices... 0 Storage Device(s) found

Device 0: unknown device
scanning bus for devices...

Device 0: unknown device
ethernet@10090000: PHY present at 0
ethernet@10090000: Starting autonegotiation...
ethernet@10090000: Autonegotiation timed out (status=0x7949)
ethernet@10090000: link down (status: 0x7949)
missing environment variable: pxeuuid
...
=&gt;</code></pre>
</li>
<li><p>當出現<code>=&gt;</code>時，便可進行下一步操作。</p>
</li>
</ol>
<h4 class="atx" id="3-安裝系統">3. 安裝系統</h4>
<ol>
<li><p>先下載一個系統鏡像，可以下載一個preinstalled的，在這裏使用[<em>Unmatched preinstalled server</em> image Ubuntu server 20.04](<a href="http://ubuntutym2.u-toyama.ac.jp/ubuntu-dvd/20.04/release/">Ubuntu 20.04.4 LTS (Focal Fossa) (u-toyama.ac.jp)</a>)為例子。</p>
<img width="648" alt="image-20220401143831931" src="file:///C:/Users/user/AppData/Roaming/Typora/typora-user-images/image-20220401143831931.png" title="">

<p> 複製下載連結，然後在樹莓派上cd到/srv/tftp，下載鏡像到此文件夾。</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token builtin class-name">cd</span> /srv/tftp

$ <span class="token function">sudo</span> <span class="token function">wget</span> http://ubuntutym2.u-toyama.ac.jp/ubuntu-dvd/20.04/release/ubuntu-20.04.4-preinstalled-server-riscv64+unmatched.img.xz</code></pre>
</li>
<li><p>下載後解壓，然後可以把文件改名，比如換成<code>ubuntu.img</code></p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> xz -d ubuntu-20.04.4-preinstalled-server-riscv64+unmatched.img.xz

$ <span class="token function">sudo</span> <span class="token function">mv</span> ubuntu-20.04.4-preinstalled-server-riscv64+unmatched.img ubuntu.img</code></pre>
</li>
<li><p>查看鏡像的大小</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">stat</span> ubuntu.img

File: ubuntu.img
  Size: <span class="token number">3758096384</span>      Blocks: <span class="token number">5719456</span>    IO Block: <span class="token number">4096</span>   regular <span class="token function">file</span>
Device: b302h/45826d    Inode: <span class="token number">131263</span>      Links: <span class="token number">1</span>
Access: <span class="token punctuation">(</span>0644/-rw-r--r--<span class="token punctuation">)</span>  Uid: <span class="token punctuation">(</span>    <span class="token number">0</span>/    root<span class="token punctuation">)</span>   Gid: <span class="token punctuation">(</span>    <span class="token number">0</span>/    root<span class="token punctuation">)</span>
Access: <span class="token number">2022</span>-04-01 09:14:52.854195481 +0000
Modify: <span class="token number">2022</span>-03-25 04:52:26.000000000 +0000
Change: <span class="token number">2022</span>-04-01 09:21:19.560816976 +0000
 Birth: -</code></pre>
<p> 記下Blocks的大小。</p>
</li>
<li><p>打開需要安裝的機器，並利用picocom連接串口</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> picocom -b <span class="token number">115200</span> /dev/ttyUSB1</code></pre>
</li>
<li><p>在啟動時會出現<code>Hit any key to stop autoboot:2</code>提示語句，按任意鍵停止autoboot後出現<code>=&gt;</code></p>
</li>
<li><p>輸入如下語句來安裝系統，其中為上面記錄的Block大小，serverip為樹莓派上eth0的IP</p>
<pre><code class="fenced-code-block language-shell"><span class="token operator">=</span><span class="token operator">&gt;</span>dhcp
<span class="token operator">=</span><span class="token operator">&gt;</span>setenv serverip <span class="token number">10.0</span>.1.5
<span class="token operator">=</span><span class="token operator">&gt;</span>tftp 0x100000000 ubuntu.img
<span class="token operator">=</span><span class="token operator">&gt;</span>pci enum
<span class="token operator">=</span><span class="token operator">&gt;</span>nvme scan
<span class="token operator">=</span><span class="token operator">&gt;</span>nvme <span class="token function">write</span> 0x100000000 <span class="token number">0</span> <span class="token operator">&lt;</span>block cnt<span class="token operator">&gt;</span>
<span class="token comment">#nvme write 0x100000000 0 5719456</span></code></pre>
</li>
<li><p>等待系統安裝</p>
</li>
<li><p>如安裝成功，重啟後應該會出現如下選項，輸入<code>1</code></p>
<pre><code class="fenced-code-block language-shell">Device <span class="token number">0</span>: Vendor: 0x144d Rev: 2B2QEXM7 Prod: S4EUNC0N929441N     
            Type: Hard Disk
            Capacity: <span class="token number">238475.1</span> MB <span class="token operator">=</span> <span class="token number">232.8</span> GB <span class="token punctuation">(</span><span class="token number">488397168</span> x <span class="token number">512</span><span class="token punctuation">)</span>
<span class="token punctuation">..</span>. is now current device
Scanning nvme <span class="token number">0</span>:1<span class="token punctuation">..</span>.
Found /boot/extlinux/extlinux.conf
Retrieving file: /boot/extlinux/extlinux.conf
U-Boot menu
<span class="token number">1</span>:      Ubuntu <span class="token number">20.04</span>.4 LTS <span class="token number">5.11</span>.0-1029-generic
<span class="token number">2</span>:      Ubuntu <span class="token number">20.04</span>.4 LTS <span class="token number">5.11</span>.0-1029-generic <span class="token punctuation">(</span>rescue target<span class="token punctuation">)</span>
Enter choice: </code></pre>
</li>
<li><p>到此便成功安裝系統，可以登入系統進行調試。</p>
</li>
</ol>
<h4 class="atx" id="4-hdmi輸出">4. HDMI輸出</h4>
<ol>
<li><p>安裝所需庫</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> build-essential libevent-dev libjpeg-dev libbsd-dev</code></pre>
</li>
<li><p>安裝<span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:0.8095em;vertical-align:-0.1944em;" class="strut"></span><span class="mord mathnormal">μ</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">re</span><span class="mord mathnormal">am</span><span style="margin-right:0.02778em;" class="mord mathnormal">er</span></span></span></span></p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">git</span> clone --depth<span class="token operator">=</span><span class="token number">1</span> https://github.com/pikvm/ustreamer
$ <span class="token builtin class-name">cd</span> ustreamer
$ <span class="token function">make</span></code></pre>
</li>
<li><p>運行<span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:0.8095em;vertical-align:-0.1944em;" class="strut"></span><span class="mord mathnormal">μ</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">re</span><span class="mord mathnormal">am</span><span style="margin-right:0.02778em;" class="mord mathnormal">er</span></span></span></span></p>
<pre><code class="fenced-code-block language-shell">$ ./ustreamer -r 1920x1080 -s :: -p <span class="token number">8080</span></code></pre>
</li>
<li><p>編寫開機服務文件<code>sudo vim /etc/systemd/system/streamer.service</code></p>
<pre><code class="fenced-code-block">[Unit]
Description=streamer daemon
After=network.target

[Service]
ExecStart=/home/ubuntu/ustreamer/ustreamer -r 1920x1080 -s :: -p 8080

[Install]
WantedBy=multi-user.target</code></pre>
</li>
<li><p>啟用服務</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> streamer.service</code></pre>
</li>
<li><p>之後在瀏覽器中打開</p>
<pre><code class="fenced-code-block">http:/IP:8080/stream</code></pre>
<p>便可以看到HDMI輸出。</p>
</li>
</ol>
<h3 class="atx" id="moodle">Moodle</h3>
<h4 class="atx" id="1-安裝moodle">1. 安裝Moodle</h4>
<ol>
<li><p>安裝Apache/MySQL/PHP</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> apache2 mysql-client mysql-server php7.4 libapache2-mod-php</code></pre>
</li>
<li><p>安裝額外軟件</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> graphviz <span class="token function">aspell</span> ghostscript clamav php7.4-pspell php7.4-curl php7.4-gd php7.4-intl php7.4-mysql php7.4-xml php7.4-xmlrpc php7.4-ldap php7.4-zip php7.4-soap php7.4-mbstring</code></pre>
<p>重啟Apache</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">service</span> apache2 restart</code></pre>
<p>安裝Git</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">git</span></code></pre>
</li>
<li><p>下載Moodle</p>
<p>在opt下載Moodle</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token builtin class-name">cd</span> /opt</code></pre>
<p>下載Moodle代碼與目錄</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">git</span> clone git://git.moodle.org/moodle.git</code></pre>
<p>進入moodle</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token builtin class-name">cd</span> moodle</code></pre>
<p>查看所有版本</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">git</span> branch -a</code></pre>
<p>選用一個版本，以39_STABLE為例</p>
<pre><code class="fenced-code-block language-shel">$ sudo git branch --track MOODLE_39_STABLE origin/MOODLE_39_STABLE
$ sudo git checkout MOODLE_39_STABLE</code></pre>
</li>
<li><p>複製本地倉庫到 /var/www/html</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">cp</span> -R /opt/moodle /var/www/html/
$ <span class="token function">sudo</span> <span class="token function">mkdir</span> /var/moodledata
$ <span class="token function">sudo</span> <span class="token function">chown</span> -R www-data /var/moodledata
$ <span class="token function">sudo</span> <span class="token function">chmod</span> -R <span class="token number">777</span> /var/moodledata
$ <span class="token function">sudo</span> <span class="token function">chmod</span> -R 0755 /var/www/html/moodle</code></pre>
</li>
<li><p>設定MySQL服務器</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">vim</span> /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre>
<pre><code class="fenced-code-block">[mysqld]
#
# * Basic Settings
#
user            = mysql
# pid-file      = /var/run/mysqld/mysqld.pid
# socket        = /var/run/mysqld/mysqld.sock
# port          = 3306
# datadir       = /var/lib/mysql
default_storage_engine = innodb #add
innodb_file_per_table = 1 #add</code></pre>
<p>重啟MySQL服務器</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">service</span> mysql restart</code></pre>
<p>登入mysql</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> mysql -u root -p</code></pre>
<p>創建數據庫</p>
<pre><code class="fenced-code-block language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> moodle <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci<span class="token punctuation">;</span></code></pre>
<p>創建用戶</p>
<pre><code class="fenced-code-block language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'admin'</span><span class="token variable">@'localhost'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'admin'</span><span class="token punctuation">;</span></code></pre>
<p>給予用戶權限</p>
<pre><code class="fenced-code-block language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span><span class="token keyword">INSERT</span><span class="token punctuation">,</span><span class="token keyword">UPDATE</span><span class="token punctuation">,</span><span class="token keyword">DELETE</span><span class="token punctuation">,</span><span class="token keyword">CREATE</span><span class="token punctuation">,</span><span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> <span class="token keyword">TABLES</span><span class="token punctuation">,</span><span class="token keyword">DROP</span><span class="token punctuation">,</span><span class="token keyword">INDEX</span><span class="token punctuation">,</span><span class="token keyword">ALTER</span> <span class="token keyword">ON</span> moodle<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'admin'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span></code></pre>
<p>退出</p>
<pre><code class="fenced-code-block language-sql">mysql<span class="token operator">&gt;</span> quit<span class="token punctuation">;</span></code></pre>
</li>
<li><p>登入網頁完成設定</p>
<pre><code class="fenced-code-block">http://IP/moodle</code></pre>
<p>設定前先開啟讀寫權限</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">chmod</span> -R <span class="token number">777</span> /var/www/html/moodle</code></pre>
<p>更改資料目錄</p>
<pre><code class="fenced-code-block">/var/moodledata</code></pre>
<p>資料庫類型</p>
<pre><code class="fenced-code-block">mysqli</code></pre>
<p>資料庫設定</p>
<pre><code class="fenced-code-block">資料庫主機 localhost
資料庫名稱 moodle
資料庫用戶名稱 admin
資料庫密碼 admin
資料表名稱的前置字元 mdl_</code></pre>
<p>設定完後改回權限</p>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">chmod</span> -R 0755 /var/www/html/moodle</code></pre>
<p><strong>允許外網訪問</strong></p>
<ol>
<li>修改apache2 port，將Listen 80改成Listen 8888</li>
</ol>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">vim</span> /etc/apache2/ports.conf
<span class="token comment">#Listen 80</span>
Listen <span class="token number">8888</span></code></pre>
<ol start="2">
<li>修改moodle的config.php，將<a href="http://IP/moodle%EF%BC%8C%E6%94%B9%E6%88%90http://IP:8888/moodle">http://IP/moodle，改成http://IP:8888/moodle</a></li>
</ol>
<pre><code class="fenced-code-block language-shell">$ <span class="token function">sudo</span> <span class="token function">vim</span> /var/www/html/moodle/config.php
<span class="token variable">$CFG</span>-<span class="token operator">&gt;</span>wwwroot   <span class="token operator">=</span> <span class="token string">'http://IP:8888/moodle'</span><span class="token punctuation">;</span></code></pre>
</li>
</ol>
<h4 class="atx" id="2-配置界面">2. 配置界面</h4>
<p>先登入管理員帳號，點擊新增課程。進入課程後，點擊新活動或資源，添加各標題與內容如下：</p>
<img width="808" alt="" src="file:///C:/Users/user/AppData/Roaming/marktext/images/2022-05-21-16-18-25-image.png" title="">

<p>分別有三個標題：</p>
<ol>
<li><p>申請U740使用帳號</p>
</li>
<li><p>預約機器使用時間</p>
</li>
<li><p>查詢預約時間及Port</p>
</li>
</ol>
<p>具體實現在<strong>配置內嵌頁面</strong>章節。</p>
<h4 class="atx" id="3-配置數據庫">3. 配置數據庫</h4>
<h5 class="atx" id="配置用來記錄機器記錄預約用戶docker訊息的實時數據庫。">配置用來記錄機器記錄預約/用戶docker訊息的實時數據庫。</h5>
<ol>
<li><p>利用MySQL創建數據庫</p>
<p>利用之前創建的用戶登入MySQL，輸入密碼。</p>
<pre><code class="fenced-code-block language-shell">$ mysql -u admin -p</code></pre>
</li>
<li><p>選擇數據庫</p>
<pre><code class="fenced-code-block language-shell">mysql<span class="token operator">&gt;</span> USE moodle<span class="token punctuation">;</span></code></pre>
</li>
<li><p>創建新的數據表</p>
<p><strong>創建記錄預約情況數據表</strong></p>
<pre><code class="fenced-code-block language-shell">mysql<span class="token operator">&gt;</span> CREATE TABLE machine_timetable<span class="token punctuation">(</span>
    -<span class="token operator">&gt;</span> period INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    -<span class="token operator">&gt;</span> machine_1 VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
    -<span class="token operator">&gt;</span> machine_2 VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
    -<span class="token operator">&gt;</span> machine_3 VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
    -<span class="token operator">&gt;</span> <span class="token punctuation">)</span>ENGINE<span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></code></pre>
<p>每欄代表：
period：時間段
machine_1~3：該時間段該機器被分配的docker name</p>
<p>usrname_1~3：該時間段該機器被分配的username</p>
<p><strong>創建記錄用戶Docker信息的數據表</strong></p>
<pre><code class="fenced-code-block language-shell">mysql<span class="token operator">&gt;</span> CREATE TABLE docker_info<span class="token punctuation">(</span>
   -<span class="token operator">&gt;</span> usr_id INT PRIMARY KEY NOT NULL,
   -<span class="token operator">&gt;</span> usr_name VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> NOT NULL,
   -<span class="token operator">&gt;</span> machine_port INT NOT NULL
   -<span class="token operator">&gt;</span> <span class="token punctuation">)</span>ENGINE<span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></code></pre>
<p>每欄代表：</p>
<ul>
<li><p>usr_id：用戶id，與moodle上的相同，以便核對用戶</p>
</li>
<li><p>usr_name：用戶申請時自行填寫的用戶名稱 </p>
</li>
<li><p>machine_port：系統生成的Docker Port</p>
</li>
</ul>
<p><strong>創建當前時間段機器使用情況的數據表</strong></p>
<pre><code class="fenced-code-block language-shell">mysql<span class="token operator">&gt;</span> CREATE TABLE machine_status<span class="token punctuation">(</span>
    -<span class="token operator">&gt;</span> period INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    -<span class="token operator">&gt;</span> machine_1 VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
    -<span class="token operator">&gt;</span> machine_2 VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
    -<span class="token operator">&gt;</span> machine_3 VARCHAR<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,
    -<span class="token operator">&gt;</span> port_1 INT NOT NULL,
    -<span class="token operator">&gt;</span> port_2 INT NOT NULL,
    -<span class="token operator">&gt;</span> port_3 INT NOT NULL
    -<span class="token operator">&gt;</span> <span class="token punctuation">)</span>ENGINE<span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></code></pre>
<p>每欄代表：</p>
<ul>
<li><p>period：當前時間段</p>
</li>
<li><p>machine_1<del>3：正在使用1</del>3號機的Docker名稱</p>
</li>
<li><p>port_1<del>3：正在使用1</del>3號機的Docker Port</p>
</li>
</ul>
</li>
</ol>
<h5 class="atx" id="編寫python-查詢更新腳本">編寫Python 查詢/更新腳本</h5>
<p>利用Python配合網站實現實時更新，對數據庫進行更新以及查詢操作。</p>
<ol>
<li><p>安裝MySQL驅動庫<code>MySQL Connector</code>，用來連接MySQL數據庫</p>
<pre><code class="fenced-code-block language-shell">$ pip3 <span class="token function">install</span> mysql-connector-python</code></pre>
</li>
<li><p>編寫數據庫更新以及查詢腳本database.py</p>
<p>database.py</p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">import</span> mysql<span class="token punctuation">.</span>connector

<span class="token comment"># 連接數據庫</span>
mydb <span class="token operator">=</span> mysql<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
  host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>
  user<span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">,</span>
  passwd<span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">,</span>
  database<span class="token operator">=</span><span class="token string">"moodle"</span>
<span class="token punctuation">)</span>

mycursor <span class="token operator">=</span> mydb<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 初始新建時間表項</span>
<span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"INSERT INTO machine_timetable (machine_1, machine_2, machine_3) VALUES (%s, %s, %s)"</span>
    val <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 每天重置時間表</span>
<span class="token keyword">def</span> <span class="token function">init_daily</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_timetable SET machine_1=NULL, machine_2=NULL, machine_3=NULL"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    rec<span class="token operator">=</span>mycursor<span class="token punctuation">.</span>rowcount
    sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_status SET machine_1=NULL, machine_2=NULL, machine_3=NULL, port_1=0, port_2=0, port_3=0"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    rec <span class="token operator">=</span> rec <span class="token operator">+</span> mycursor<span class="token punctuation">.</span>rowcount

    <span class="token keyword">print</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">"record(s) affected"</span><span class="token punctuation">)</span>

<span class="token comment"># 返回用戶是否在數據庫中</span>
<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM docker_info WHERE usr_name ='"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">'\''</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> myresult<span class="token punctuation">:</span>
        <span class="token keyword">return</span> myresult<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">check_id</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM docker_info WHERE usr_id = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> myresult<span class="token punctuation">:</span>
        <span class="token keyword">return</span> myresult<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token comment"># 返回用戶數量，用於分配Port</span>
<span class="token keyword">def</span> <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM docker_info"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>myresult<span class="token punctuation">)</span>

<span class="token comment"># 新增用戶到數據庫</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_num <span class="token operator">=</span> check_size<span class="token punctuation">(</span><span class="token punctuation">)</span>
    port <span class="token operator">=</span> <span class="token number">20000</span> <span class="token operator">+</span> user_num
    sql <span class="token operator">=</span> <span class="token string">"INSERT INTO docker_info (usr_id, usr_name, machine_port) VALUES (%s, %s, %s)"</span>
    val <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> usr_name<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> mycursor<span class="token punctuation">.</span>rowcount

<span class="token comment"># 返回預約時間表空閒機器數量</span>
<span class="token keyword">def</span> <span class="token function">check_all_available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_1, machine_2, machine_3 FROM machine_timetable"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    available <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> res <span class="token keyword">in</span> myresult<span class="token punctuation">:</span>
        available<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> available

<span class="token comment"># 返回某一時間段的預約時間表空閒機器數量</span>
<span class="token keyword">def</span> <span class="token function">check_one_available</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_1, machine_2, machine_3 FROM machine_timetable WHERE period="</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    available <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> myresult<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> available

<span class="token comment"># 返回某一時間段的預約時間表空閒機器數量</span>
<span class="token keyword">def</span> <span class="token function">check_available_index</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_1, machine_2, machine_3 FROM machine_timetable WHERE period="</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    available <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> myresult<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    machine_no <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i<span class="token punctuation">,</span> x <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>available<span class="token punctuation">)</span> <span class="token keyword">if</span> x<span class="token punctuation">]</span>

    <span class="token comment">#if machine_no:</span>
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>machine_no<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

<span class="token comment"># 更新預約時間表</span>
<span class="token keyword">def</span> <span class="token function">update_timetable</span><span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> docker_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#machine_no = str(int(check_one_available(period)) + 1)</span>
    sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_timetable SET machine_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>machine_no<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'= \''</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\' WHERE period = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> mycursor<span class="token punctuation">.</span>rowcount

<span class="token comment"># 更新當前時間段機器使用狀態</span>
<span class="token keyword">def</span> <span class="token function">update_status</span><span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> docker_name<span class="token punctuation">)</span><span class="token punctuation">:</span>

    port <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">if</span> docker_name <span class="token operator">!=</span> <span class="token string">"NULL"</span><span class="token punctuation">:</span>
        usr_name<span class="token operator">=</span>docker_name <span class="token comment">#[0:len(docker_name)-2]</span>
        port <span class="token operator">=</span> get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
        sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_status SET machine_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>machine_no<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"= \'"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>docker_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\'"</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_status SET machine_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>machine_no<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"= NULL"</span>

    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_status SET port_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>machine_no<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"= \'"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\'"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    sql <span class="token operator">=</span> <span class="token string">"UPDATE machine_status SET period=\'"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\'"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> mycursor<span class="token punctuation">.</span>rowcount

<span class="token comment"># 返回Port</span>
<span class="token keyword">def</span> <span class="token function">get_port</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_port FROM docker_info WHERE usr_name= '"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"\'"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> myresult<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment"># 返回當前機器使用狀態</span>
<span class="token keyword">def</span> <span class="token function">get_status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_1, machine_2, machine_3 FROM machine_status"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> myresult

<span class="token comment"># 返回某個時間段的預約時間表</span>
<span class="token keyword">def</span> <span class="token function">get_timetable</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_1, machine_2, machine_3 FROM machine_timetable WHERE period= '"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\''</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> myresult

<span class="token comment"># 返回某個時間段的一個機器預約時間表</span>
<span class="token keyword">def</span> <span class="token function">get_one_timetable</span><span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT machine_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>machine_no<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" FROM machine_timetable WHERE period= '"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\''</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> myresult<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment"># 返回當前機器使用Port</span>
<span class="token keyword">def</span> <span class="token function">get_status_port</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT port_1, port_2, port_3 FROM machine_status"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> myresult

<span class="token comment"># 返回用戶使用時間段以及Port</span>
<span class="token keyword">def</span> <span class="token function">get_status_port_queries</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    n_res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    queries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT period, machine_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" FROM machine_timetable WHERE machine_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"=\'"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\'"</span>
        mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        myresult <span class="token operator">=</span> mycursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> myresult<span class="token punctuation">:</span>
          result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> res <span class="token keyword">in</span> result<span class="token punctuation">:</span>
        period <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':00 -- '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':00'</span>
        usr_name <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        port <span class="token operator">=</span> get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
        queries<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>period<span class="token punctuation">,</span> port<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> queries

<span class="token keyword">def</span> <span class="token function">update_url</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span>

    sql <span class="token operator">=</span> <span class="token string">"UPDATE mdl_url SET externalurl='http://"</span> <span class="token operator">+</span> ip <span class="token operator">+</span> <span class="token string">":8188/apply\' WHERE id=1"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    sql <span class="token operator">=</span> <span class="token string">"UPDATE mdl_url SET externalurl='http://"</span> <span class="token operator">+</span> ip <span class="token operator">+</span> <span class="token string">":8188/register\' WHERE id=2"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    sql <span class="token operator">=</span> <span class="token string">"UPDATE mdl_url SET externalurl='http://"</span> <span class="token operator">+</span> ip <span class="token operator">+</span> <span class="token string">":8188/query\' WHERE id=3"</span>
    mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    mydb<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> mycursor<span class="token punctuation">.</span>rowcount</code></pre>
</li>
</ol>
<h4 class="atx" id="4--配置內嵌頁面">4.  配置內嵌頁面</h4>
<p>通過python和html完成申請、預約與查詢網頁</p>
<h5 class="atx" id="申請網站-registerpy與registerhtml">申請網站 register.py與register.html</h5>
<p>   界面如下圖</p>
<p>   <img alt="" src="file:///C:/Users/user/AppData/Roaming/marktext/images/2022-05-21-22-54-15-image.png"></p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span>  
<span class="token keyword">import</span> database
<span class="token keyword">from</span> my_docker <span class="token keyword">import</span> docker_manage
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> subprocess

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    usr_name <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        usr_name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span>
        ssh_key <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'ssh_key'</span><span class="token punctuation">)</span>

        <span class="token comment"># 判斷用戶名以及SSH KEY是否為空</span>
        <span class="token keyword">if</span> usr_name <span class="token operator">!=</span> <span class="token string">''</span> <span class="token keyword">and</span> usr_name <span class="token operator">!=</span> <span class="token string">' '</span> <span class="token keyword">and</span> usr_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> ssh_key <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">:</span>

            <span class="token comment"># 檢查用戶是否已在數據庫中</span>
            existed <span class="token operator">=</span> database<span class="token punctuation">.</span>check_id<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>

            <span class="token comment"># 不存在則報錯</span>
            <span class="token keyword">if</span> existed <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> existed<span class="token operator">=</span>existed<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                path <span class="token operator">=</span> <span class="token string">"/docker_usr/info/"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">"/log"</span>
                Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                path <span class="token operator">=</span> <span class="token string">"./my_docker/ssh_keys/"</span> <span class="token operator">+</span> usr_name
                Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                filename <span class="token operator">=</span> <span class="token string">"/authorized_keys"</span>

                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path <span class="token operator">+</span> filename<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ssh_key <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                <span class="token comment"># 數據庫中添加用戶</span>
                result <span class="token operator">=</span> database<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>

                <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    outputs <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>make_docker<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span> 

                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> success<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>

                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> fail<span class="token operator">=</span><span class="token string">'fail'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> wrong_info<span class="token operator">=</span><span class="token string">'wrong'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8184</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre>
<p>register.html</p>
<pre><code class="fenced-code-block">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;U740 Register&lt;/title&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;

    &lt;script&gt;
      function showButtonEvent()
      {        
        document.getElementById("Wait").style.display="block";  
      }
    &lt;/script&gt;
  &lt;/head&gt;

  &lt;style&gt;
    .info {
      padding: 20px 10px;
      border:none;
      text-align: center;
      font-size: 200%;
      background: rgb(41, 105, 176, 0.7);
      color: rgb(255, 255, 255);
      border-radius: 4px;
    }

    .info2 {
      padding: 20px 10px;
      border:none;
      text-align: center;
      font-size: 100%;
      background: rgb(41, 105, 176, 0.7);
      color: rgb(255, 255, 255);
      border-radius: 4px;
    }

    .button {
      background-color: #4CAF50; /* Green */
      border: none;
      color: white;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 20px;
    }

  &lt;/style&gt;
  &lt;body style="background-color:rgb(248, 236, 182);"&gt;  
    &lt;center&gt;
    &lt;div class="container"&gt;
      &lt;br&gt;&lt;span class="info"&gt;申请需知&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
      该项目 (U740线上调试环境) 目前尚处于测试阶段，请输入用户名以及SSH Key后点击申请
      &lt;form action="" method="post" onsubmit="document.getElementById('btn').disabled=true;"&gt;
        &lt;br&gt;
        用户名：&lt;input type="text" placeholder="请输入用户名" name="usr_name" value="{{ request.form.usr_name }}"&gt;
        &lt;br&gt;
        SSH Key：&lt;input type="text" placeholder="请输入SSH Key" name="ssh_key" value="{{ request.form.ssh_key }}"&gt;
        &lt;br&gt;
        {% if success %}
          &lt;p class="apply"&gt;&lt;strong&gt;用户 "{{ success }}" 申请成功！若要使用机器请预约时间&lt;/strong&gt;
        {% endif %}
        {% if fail %}
          &lt;p class="apply"&gt;&lt;strong&gt;系统错误，请重新申请&lt;/strong&gt;
        {% endif %}

        &lt;br&gt;
        {% if not success %}
        &lt;input id="btn" class="button" type="submit" value="申请" onclick="showButtonEvent()"&gt;
        {% endif %}

        {% if wrong_info %}
          &lt;p class="apply"&gt;&lt;strong&gt;请输入用户名以及SSH Key！&lt;/strong&gt;
        {% endif %}

        {% if existed %}
          &lt;p class="apply"&gt;&lt;strong&gt;该Moodle帐号已注册过&lt;/strong&gt;
        {% endif %}
      &lt;/form&gt;

      &lt;br&gt;
      &lt;div id="Wait" style="display: none;"&gt;
        &lt;span class="info2"&gt;申请中，请稍等片刻&lt;/span&gt;
      &lt;/div&gt;


    &lt;/div&gt;
    &lt;/center&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<h5 class="atx" id="預約與查詢網站applypy與applyhtml-successhtml-failhtml">預約與查詢網站apply.py與apply.html, success.html, fail.html</h5>
<p>   界面如下圖</p>
<p>   預約</p>
<p>   <img alt="" src="file:///C:/Users/user/AppData/Roaming/marktext/images/2022-05-21-23-02-56-image.png"></p>
<p>   查詢</p>
<p>   <img alt="" src="file:///C:/Users/user/AppData/Roaming/marktext/images/2022-05-21-23-04-22-image.png"></p>
<p>   apply.py</p>
<pre><code class="fenced-code-block language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span>  
<span class="token keyword">from</span> time <span class="token keyword">import</span> localtime
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> database

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token comment"># 查詢</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/query'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        usr_name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> usr_name <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">:</span>
            <span class="token comment"># 檢查用戶是否存在數據庫中</span>
            usr_exist <span class="token operator">=</span> database<span class="token punctuation">.</span>check<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
            <span class="token keyword">if</span> usr_exist <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                queries <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status_port_queries<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
                <span class="token comment"># 如果查詢預約時間段不為空</span>
                <span class="token keyword">if</span> queries<span class="token punctuation">:</span>
                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> queries<span class="token operator">=</span>queries<span class="token punctuation">,</span> usr_name<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>
                <span class="token comment"># 為空</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> no_query<span class="token operator">=</span><span class="token string">'yes'</span><span class="token punctuation">,</span> usr_name<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>
            <span class="token comment"># 用戶不存在</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> wrong_username<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>
        <span class="token comment"># 查詢用戶名稱為空</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> no_username<span class="token operator">=</span><span class="token string">'no_username'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">)</span>

<span class="token comment"># 申請</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/apply'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        <span class="token comment"># 獲取用戶名、時間段</span>
        usr_name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span>
        period <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'time_dialog'</span><span class="token punctuation">)</span>
        period <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>period<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>period<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span>
        usr_exist <span class="token operator">=</span> database<span class="token punctuation">.</span>check<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
        usr_appointment <span class="token operator">=</span> usr_name <span class="token keyword">in</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

        <span class="token comment">#  檢查用戶名稱是否存在</span>
        <span class="token keyword">if</span> usr_exist <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> usr_appointment <span class="token keyword">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span>
            previous_usrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> period <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                previous_usrs <span class="token operator">=</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                previous_usrs <span class="token operator">=</span> previous_usrs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> usr_name <span class="token keyword">in</span> previous_usrs<span class="token punctuation">:</span>
                prev_machine_no <span class="token operator">=</span> previous_usrs<span class="token punctuation">.</span>index<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                now_machine_no <span class="token operator">=</span> database<span class="token punctuation">.</span>check_available_index<span class="token punctuation">(</span>period<span class="token punctuation">)</span>
                reserved_usr <span class="token operator">=</span> database<span class="token punctuation">.</span>get_one_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> prev_machine_no<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> reserved_usr <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    <span class="token comment"># switch</span>
                    database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> prev_machine_no<span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>
                    database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> now_machine_no<span class="token punctuation">,</span> reserved_usr<span class="token punctuation">)</span>
                    port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>

                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> prev_machine_no<span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>
                    port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>

            <span class="token keyword">else</span><span class="token punctuation">:</span>
                machine_no <span class="token operator">=</span> database<span class="token punctuation">.</span>check_available_index<span class="token punctuation">(</span>period<span class="token punctuation">)</span>
                port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
                database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>

            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'success.html'</span><span class="token punctuation">,</span> port<span class="token operator">=</span>port<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'fail.html'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        available <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token comment"># 獲取空閒機器數量</span>
        available <span class="token operator">=</span> database<span class="token punctuation">.</span>check_all_available<span class="token punctuation">(</span><span class="token punctuation">)</span>

        t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>available<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果大於或等於預約時間即不可用</span>
            <span class="token keyword">if</span> i <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">&lt;=</span> t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">:</span>
                available<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token comment"># available1~12代表12個時段空閒機器數量</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'apply.html'</span><span class="token punctuation">,</span> 
                                available1<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                available2<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available3<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available4<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available5<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available6<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available7<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available8<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available9<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available10<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available11<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                available12<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    database<span class="token punctuation">.</span>init_daily<span class="token punctuation">(</span><span class="token punctuation">)</span>

    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

    log_name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_year<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_mon<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_mday<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.log'</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'LOG for '</span> <span class="token operator">+</span> log_name <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8183</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre>
<p>   apply.html</p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>U740 apply<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token attr-name">ne</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">table, th, td</span> <span class="token punctuation">{</span>
        <span class="token property">border</span><span class="token punctuation">:</span>1px solid black<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.button</span> <span class="token punctuation">{</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> #4CAF50<span class="token punctuation">;</span> <span class="token comment">/* Green */</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 10px 20px<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.dialog</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span>1px solid #000<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.info</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>210px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span>1px solid #000<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">tr</span><span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>350px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span>70px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span>1px solid #000<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 150<span class="token punctuation">,</span> 45<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.active</span><span class="token punctuation">{</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>77<span class="token punctuation">,</span> 179<span class="token punctuation">,</span> 233<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-color</span><span class="token punctuation">:</span><span class="token function">rgb</span><span class="token punctuation">(</span>248<span class="token punctuation">,</span> 236<span class="token punctuation">,</span> 182<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-horizontal<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">border-width</span><span class="token punctuation">:</span> 2px <span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> 250px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 20px <span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span> <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>41<span class="token punctuation">,</span> 105<span class="token punctuation">,</span> 176<span class="token punctuation">,</span> 0.7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>请输入用户名并选择申请时间段<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dialog<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入用户名<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>usr_name<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>usr_name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ request.form.usr_name }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myTable<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                    {% if available1 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>10:00 - 11:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available1 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available2 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>11:00 - 12:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available2 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available3 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>12:00 - 13:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available3 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available4 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>13:00 - 14:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available4 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                    {% if available5 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>14:00 - 15:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available5 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available6 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>15:00 - 16:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available6 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available7 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>16:00 - 17:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available7 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available8 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>17:00 - 18:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available8 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                    {% if available9 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>18:00 - 19:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available9  }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available10 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>19:00 - 20:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available10 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available11 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>20:00 - 21:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available11 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}

                    {% if available12 %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>21:00 - 22:00 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span> 可用机器：{{ available12 }} 台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% else %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>该时间段已过或已约满<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                    {% endif %}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>time_dialog<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>time_dialog<span class="token punctuation">"</span></span> <span class="token attr-name">readonly</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>readonly<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>此处会显示你所选择的时间段信息<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sub<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>预约<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sub<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'sub'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> invalid  <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'time_dialog'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">var</span> usr_name <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>usr_name <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请输入用户名！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>invalid <span class="token operator">==</span> <span class="token string">'此处会显示你所选择的时间段信息'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请选择时间段！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>invalid <span class="token operator">!=</span> <span class="token string">'此处会显示你所选择的时间段信息'</span> <span class="token operator">&amp;&amp;</span> usr_name <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'请确认你的用户名为: '</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span> invalid <span class="token operator">+</span> <span class="token string">'\n如有错请点击取消'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'th'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> period <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>period <span class="token operator">!=</span> <span class="token string">"该时间段已过或已约满"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'th'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            period_start <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
            period_end   <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">;</span>

            document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"time_dialog"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"你所选择的时间段为: "</span> <span class="token operator">+</span> period_start <span class="token operator">+</span> <span class="token string">":00 --"</span> <span class="token operator">+</span> period_end <span class="token operator">+</span> <span class="token string">":00"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>   success.html</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>U740 apply success<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.info</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 20px 10px<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>41<span class="token punctuation">,</span> 105<span class="token punctuation">,</span> 176<span class="token punctuation">,</span> 0.7<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.button</span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #4CAF50<span class="token punctuation">;</span> <span class="token comment">/* Green */</span>
      <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 10px 20px<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-color</span><span class="token punctuation">:</span><span class="token function">rgb</span><span class="token punctuation">(</span>248<span class="token punctuation">,</span> 236<span class="token punctuation">,</span> 182<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      {% if port %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>分配成功，请使用该Port登陆Docker:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span> {{ port }}
      {% endif %}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token literal-property property">javascript</span><span class="token operator">:</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>返回上一页<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>   fail.html</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>U740 apply<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.info</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 20px 10px<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>41<span class="token punctuation">,</span> 105<span class="token punctuation">,</span> 176<span class="token punctuation">,</span> 0.7<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.button</span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #4CAF50<span class="token punctuation">;</span> <span class="token comment">/* Green */</span>
      <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 10px 20px<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-color</span><span class="token punctuation">:</span><span class="token function">rgb</span><span class="token punctuation">(</span>248<span class="token punctuation">,</span> 236<span class="token punctuation">,</span> 182<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>分配失败，请检查是否输入正确帐号或已预约该时段。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token literal-property property">javascript</span><span class="token operator">:</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>返回上一页<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>   query.html</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>U740 Query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">ne</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.info</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 20px 10px<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>41<span class="token punctuation">,</span> 105<span class="token punctuation">,</span> 176<span class="token punctuation">,</span> 0.7<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.button</span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #4CAF50<span class="token punctuation">;</span> <span class="token comment">/* Green */</span>
      <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 10px 20px<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.dialog</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span>1px solid #000<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-color</span><span class="token punctuation">:</span><span class="token function">rgb</span><span class="token punctuation">(</span>248<span class="token punctuation">,</span> 236<span class="token punctuation">,</span> 182<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>预约时间段及Port查询<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      输入用户名查询
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">onsubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dialog<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>用户名<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>usr_name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ request.form.usr_name }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>查询<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

      {% if queries %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>用户 "{{ usr_name }}" 预约情况如下：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        {% for query in queries %}
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>时间段：{{ query[0] }} || Port: {{ query[1] }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        {% endfor %}
      {% endif %}

      {% if no_query %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>用户 "{{ usr_name }}" 今天没有任何预约！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      {% endif %}

      {% if no_username %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>请输入用户名！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      {% endif %}

      {% if wrong_username %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>请检查用户名称 "{{ wrong_username }}" 是否正确！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      {% endif %}

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<h5 class="atx" id="整合網站-moodlepy">整合網站 moodle.py</h5>
<pre><code class="fenced-code-block language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token operator">*</span>  
<span class="token keyword">from</span> time <span class="token keyword">import</span> localtime
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> database
<span class="token keyword">from</span> time <span class="token keyword">import</span> timezone
<span class="token keyword">from</span> flask_apscheduler <span class="token keyword">import</span> APScheduler
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> my_docker <span class="token keyword">import</span> docker_manage
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> check
<span class="token keyword">import</span> socket

<span class="token keyword">def</span> <span class="token function">get_host_ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'8.8.8.8'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ip <span class="token operator">=</span> s<span class="token punctuation">.</span>getsockname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ip


<span class="token comment"># 服務器定期更新</span>

<span class="token comment"># 每整點更新一次，用於Docker的更新</span>
server_update_time_week <span class="token operator">=</span> <span class="token string">'0-6'</span> <span class="token comment"># * 代表 週一到週日工作</span>
server_update_time_hour <span class="token operator">=</span> <span class="token string">'10-21'</span> <span class="token comment"># 10-21 代表 10點開始第一次更新，21點最後一次更新</span>
server_update_time_min <span class="token operator">=</span> <span class="token string">'00'</span> <span class="token comment"># 代表 XX:00:XX 更新</span>
server_update_time_sec <span class="token operator">=</span> <span class="token string">'01'</span> <span class="token comment"># 代表 XX:XX:01 更新</span>

<span class="token comment"># 每整點的55分檢查一次，用於提前5分鐘斷線的提示</span>
server_check_time_week <span class="token operator">=</span> <span class="token string">'0-6'</span>
server_check_time_hour <span class="token operator">=</span> <span class="token string">'10-21'</span>
server_check_time_min <span class="token operator">=</span> <span class="token string">'55'</span> <span class="token comment"># 代表 XX:55:XX 更新</span>
server_check_time_sec <span class="token operator">=</span> <span class="token string">'01'</span>

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    SCHEDULER_API_ENABLED <span class="token operator">=</span> <span class="token boolean">True</span>

scheduler <span class="token operator">=</span> APScheduler<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 到時前五分鐘提示</span>
<span class="token decorator annotation punctuation">@scheduler<span class="token punctuation">.</span>task</span><span class="token punctuation">(</span><span class="token string">'cron'</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">'expired_remind'</span><span class="token punctuation">,</span> day_of_week<span class="token operator">=</span>server_check_time_week<span class="token punctuation">,</span> 
                                             hour<span class="token operator">=</span>server_check_time_hour<span class="token punctuation">,</span> 
                                             minute<span class="token operator">=</span>server_check_time_min<span class="token punctuation">,</span>
                                             second<span class="token operator">=</span>server_check_time_sec<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">expired_remind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    now_user_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    now_user_names <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> now_user_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> now_user_names<span class="token punctuation">:</span>
        <span class="token keyword">for</span> now_user_name <span class="token keyword">in</span> now_user_names<span class="token punctuation">:</span>
            check<span class="token punctuation">.</span>expired_remind<span class="token punctuation">(</span>now_user_name<span class="token punctuation">)</span>


<span class="token comment"># 更新時間表  </span>
<span class="token decorator annotation punctuation">@scheduler<span class="token punctuation">.</span>task</span><span class="token punctuation">(</span><span class="token string">'cron'</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">'update_timetable'</span><span class="token punctuation">,</span>day_of_week<span class="token operator">=</span>server_update_time_week<span class="token punctuation">,</span> 
                                              hour<span class="token operator">=</span>server_update_time_hour<span class="token punctuation">,</span> 
                                              minute<span class="token operator">=</span>server_update_time_min<span class="token punctuation">,</span>
                                              second<span class="token operator">=</span>server_update_time_sec<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">update_machine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    period <span class="token operator">=</span> t<span class="token punctuation">.</span>tm_hour <span class="token operator">-</span> <span class="token number">9</span>


    <span class="token comment"># 獲取下個時間段使用信息</span>
    next_user_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 判斷下個時間段是否有人使用，即時間表中是否為 'NULL'</span>
    next_user_exist <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> next_user_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

    <span class="token comment"># 第一個時間段不用特殊判斷</span>
    <span class="token keyword">if</span> period <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>

        <span class="token comment">#user_names = [x for x in user_names if x is not None]</span>

        <span class="token comment"># 如果預約時間表不為空，即有人預約</span>
        <span class="token keyword">if</span> next_user_names<span class="token punctuation">:</span>
            <span class="token keyword">for</span> next_user_name <span class="token keyword">in</span> next_user_names<span class="token punctuation">:</span>
                <span class="token keyword">if</span> next_user_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>next_user_name<span class="token punctuation">)</span>

                    machine_no <span class="token operator">=</span> next_user_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>next_user_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

                    output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>start_docker<span class="token punctuation">(</span>next_user_name<span class="token punctuation">,</span> port<span class="token punctuation">,</span> machine_no<span class="token punctuation">)</span>

                    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                    <span class="token comment"># 記錄Docker啟動時間</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Start docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                    <span class="token comment"># 更新當前機器使用狀態</span>
                    database<span class="token punctuation">.</span>update_status<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> next_user_name<span class="token punctuation">)</span>

    <span class="token comment"># 之後的時間段，需要判斷 下個時間段有否預約，是否為同一人預約，是否使用同一機器</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        now_user_names <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        now_user_exist <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> now_user_names <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">]</span>

        <span class="token comment"># 下個時間段有人預約</span>
        <span class="token keyword">if</span> next_user_exist<span class="token punctuation">:</span>
            <span class="token comment"># 如果目前機器有分配用戶</span>
            <span class="token comment"># 則檢查下個時間段該用戶是否使用同一機器</span>
            <span class="token comment"># 若為同一機器則不中斷SSH連線，若不為同一機器則中斷SSH連線(停止Docker)</span>
            <span class="token keyword">if</span> now_user_exist<span class="token punctuation">:</span>
                <span class="token keyword">for</span> now_user_name <span class="token keyword">in</span> now_user_names<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> now_user_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                        <span class="token comment"># 不為同一人</span>
                        <span class="token keyword">if</span> now_user_name <span class="token keyword">not</span> <span class="token keyword">in</span> next_user_names<span class="token punctuation">:</span>

                            t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                            machine_no <span class="token operator">=</span> now_user_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>now_user_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

                            <span class="token comment"># 停止Docker</span>
                            output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>stop_docker<span class="token punctuation">(</span>now_user_name<span class="token punctuation">,</span> machine_no<span class="token punctuation">)</span>

                            <span class="token comment"># 記錄Docker停止時間</span>
                            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Stop  docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            now_machine_no <span class="token operator">=</span> now_user_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>now_user_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                            next_machine_no <span class="token operator">=</span> next_user_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>now_user_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

                            <span class="token keyword">if</span> now_machine_no <span class="token operator">!=</span> next_machine_no<span class="token punctuation">:</span>
                                output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>stop_docker<span class="token punctuation">(</span>now_user_name<span class="token punctuation">,</span> now_machine_no<span class="token punctuation">)</span>

                                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Stop  docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>


            <span class="token comment"># 根據預約時間表啟動下個時間段的Docker</span>
            <span class="token keyword">for</span> next_user_name <span class="token keyword">in</span> next_user_names<span class="token punctuation">:</span>
                <span class="token keyword">if</span> next_user_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> next_user_name <span class="token keyword">not</span> <span class="token keyword">in</span> now_user_names<span class="token punctuation">:</span>

                    port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>next_user_name<span class="token punctuation">)</span>
                    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                    machine_no <span class="token operator">=</span> next_user_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>next_user_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

                    output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>start_docker<span class="token punctuation">(</span>next_user_name<span class="token punctuation">,</span> port<span class="token punctuation">,</span> machine_no<span class="token punctuation">)</span>

                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Start docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                    <span class="token comment"># 更新當前機器使用狀態</span>
                    database<span class="token punctuation">.</span>update_status<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> next_user_name<span class="token punctuation">)</span>

        <span class="token comment"># 下個時間段沒有預約</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 檢查當前分配的用戶是否正在使用 &lt;-- 檢查SSH連線情況，如果SSH用戶為0，則Docker沒人使用</span>
            <span class="token keyword">if</span> now_user_exist<span class="token punctuation">:</span>
                <span class="token keyword">for</span> now_user_name <span class="token keyword">in</span> now_user_names<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> now_user_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                        ssh_usr <span class="token operator">=</span> check<span class="token punctuation">.</span>check_alive<span class="token punctuation">(</span>now_user_name<span class="token punctuation">)</span>

                        <span class="token keyword">if</span> ssh_usr <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>

                            t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

                            machine_no <span class="token operator">=</span> now_user_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>now_user_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

                            <span class="token comment"># 停止Docker</span>
                            output <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>stop_docker<span class="token punctuation">(</span>now_user_name<span class="token punctuation">,</span> machine_no<span class="token punctuation">)</span>

                            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Stop  docker '</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">' at '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_min<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_sec<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                            <span class="token comment"># 保存用戶操作記錄</span>
                            <span class="token comment"># check.save_user_log(now_user_name, machine_no)</span>

                            <span class="token comment"># 更新當前機器使用狀態</span>
                            database<span class="token punctuation">.</span>update_status<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> <span class="token string">'NULL'</span><span class="token punctuation">)</span>

<span class="token comment"># 申請帳號</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    usr_name <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        usr_name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span>
        ssh_key <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'ssh_key'</span><span class="token punctuation">)</span>

        <span class="token comment"># 判斷用戶名以及SSH KEY是否為空</span>
        <span class="token keyword">if</span> usr_name <span class="token operator">!=</span> <span class="token string">''</span> <span class="token keyword">and</span> usr_name <span class="token operator">!=</span> <span class="token string">' '</span> <span class="token keyword">and</span> usr_name <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> ssh_key <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">:</span>

            <span class="token comment"># 檢查用戶是否已在數據庫中</span>
            existed <span class="token operator">=</span> database<span class="token punctuation">.</span>check_id<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>

            <span class="token comment"># 不存在則報錯</span>
            <span class="token keyword">if</span> existed <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> existed<span class="token operator">=</span>existed<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                path <span class="token operator">=</span> <span class="token string">"/docker_usr/info/"</span> <span class="token operator">+</span> usr_name <span class="token operator">+</span> <span class="token string">"/log"</span>
                Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                path <span class="token operator">=</span> <span class="token string">"./my_docker/ssh_keys/"</span> <span class="token operator">+</span> usr_name
                Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                filename <span class="token operator">=</span> <span class="token string">"/authorized_keys"</span>

                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path <span class="token operator">+</span> filename<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ssh_key <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

                <span class="token comment"># 數據庫中添加用戶</span>
                result <span class="token operator">=</span> database<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>

                <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    outputs <span class="token operator">=</span> docker_manage<span class="token punctuation">.</span>make_docker<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span> 

                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> success<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>

                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> fail<span class="token operator">=</span><span class="token string">'fail'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> wrong_info<span class="token operator">=</span><span class="token string">'wrong'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">)</span>

<span class="token comment"># 查詢預約</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/query'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        usr_name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> usr_name <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">:</span>
            <span class="token comment"># 檢查用戶是否存在數據庫中</span>
            usr_exist <span class="token operator">=</span> database<span class="token punctuation">.</span>check<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
            <span class="token keyword">if</span> usr_exist <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                queries <span class="token operator">=</span> database<span class="token punctuation">.</span>get_status_port_queries<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
                <span class="token comment"># 如果查詢預約時間段不為空</span>
                <span class="token keyword">if</span> queries<span class="token punctuation">:</span>
                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> queries<span class="token operator">=</span>queries<span class="token punctuation">,</span> usr_name<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>
                <span class="token comment"># 為空</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> no_query<span class="token operator">=</span><span class="token string">'yes'</span><span class="token punctuation">,</span> usr_name<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>
            <span class="token comment"># 用戶不存在</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> wrong_username<span class="token operator">=</span>usr_name<span class="token punctuation">)</span>
        <span class="token comment"># 查詢用戶名稱為空</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">,</span> no_username<span class="token operator">=</span><span class="token string">'no_username'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'query.html'</span><span class="token punctuation">)</span>

<span class="token comment"># 預約時間</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/apply'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        <span class="token comment"># 獲取用戶名、時間段</span>
        usr_name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'usr_name'</span><span class="token punctuation">)</span>
        period <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'time_dialog'</span><span class="token punctuation">)</span>
        period <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>period<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>period<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span>
        usr_exist <span class="token operator">=</span> database<span class="token punctuation">.</span>check<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
        usr_appointment <span class="token operator">=</span> usr_name <span class="token keyword">in</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

        <span class="token comment">#  檢查用戶名稱是否存在</span>
        <span class="token keyword">if</span> usr_exist <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> usr_appointment <span class="token keyword">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span>
            previous_usrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> period <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                previous_usrs <span class="token operator">=</span> database<span class="token punctuation">.</span>get_timetable<span class="token punctuation">(</span>period <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                previous_usrs <span class="token operator">=</span> previous_usrs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> usr_name <span class="token keyword">in</span> previous_usrs<span class="token punctuation">:</span>
                prev_machine_no <span class="token operator">=</span> previous_usrs<span class="token punctuation">.</span>index<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
                now_machine_no <span class="token operator">=</span> database<span class="token punctuation">.</span>check_available_index<span class="token punctuation">(</span>period<span class="token punctuation">)</span>
                reserved_usr <span class="token operator">=</span> database<span class="token punctuation">.</span>get_one_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> prev_machine_no<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> reserved_usr <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    <span class="token comment"># switch</span>
                    database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> prev_machine_no<span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>
                    database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> now_machine_no<span class="token punctuation">,</span> reserved_usr<span class="token punctuation">)</span>
                    port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>

                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> prev_machine_no<span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>
                    port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>

            <span class="token keyword">else</span><span class="token punctuation">:</span>
                machine_no <span class="token operator">=</span> database<span class="token punctuation">.</span>check_available_index<span class="token punctuation">(</span>period<span class="token punctuation">)</span>
                port <span class="token operator">=</span> database<span class="token punctuation">.</span>get_port<span class="token punctuation">(</span>usr_name<span class="token punctuation">)</span>
                database<span class="token punctuation">.</span>update_timetable<span class="token punctuation">(</span>period<span class="token punctuation">,</span> machine_no<span class="token punctuation">,</span> usr_name<span class="token punctuation">)</span>

            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'success.html'</span><span class="token punctuation">,</span> port<span class="token operator">=</span>port<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'fail.html'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        available <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token comment"># 獲取空閒機器數量</span>
        available <span class="token operator">=</span> database<span class="token punctuation">.</span>check_all_available<span class="token punctuation">(</span><span class="token punctuation">)</span>

        t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>available<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果大於或等於預約時間即不可用</span>
            <span class="token keyword">if</span> i <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">&lt;=</span> t<span class="token punctuation">.</span>tm_hour<span class="token punctuation">:</span>
                available<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token comment"># available1~12代表12個時段空閒機器數量</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'apply.html'</span><span class="token punctuation">,</span> 
                                available1<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                available2<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available3<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available4<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available5<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available6<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available7<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available8<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available9<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available10<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                available11<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                available12<span class="token operator">=</span>available<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    ip <span class="token operator">=</span> get_host_ip<span class="token punctuation">(</span><span class="token punctuation">)</span>

    database<span class="token punctuation">.</span>update_url<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>

    app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>Config<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    scheduler<span class="token punctuation">.</span>init_app<span class="token punctuation">(</span>app<span class="token punctuation">)</span>
    scheduler<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

    database<span class="token punctuation">.</span>init_daily<span class="token punctuation">(</span><span class="token punctuation">)</span>

    t <span class="token operator">=</span> localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>

    log_name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_year<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_mon<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tm_mday<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.log'</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/home/ubuntu/applysystem/log/"</span> <span class="token operator">+</span> log_name<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'LOG for '</span> <span class="token operator">+</span> log_name <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>

    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8188</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre>
</article>
</body>
</html>